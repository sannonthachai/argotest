var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t;import{_ as o}from"./VPlaceholderSection.vue_vue&type=script&setup=true&lang.35b0ad2a.js";import{c as u,e as d}from"./index.d7dc1ff6.js";import{_ as r}from"./VModal.31b4f4ba.js";import{_ as c,a as p}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{_ as v}from"./FeatureGroupOption.vue_vue&type=script&setup=true&lang.95badc66.js";import{p as f,a as m,d as h,T as y,k as b,r as g,S as x,E as k,o as I,e as _,x as G,F as D,h as V,t as P,g as S,K as j,V as L,i as O,n as Y,ai as C,ao as U,ap as E,H as w,I as F,G as M,q as N,A as q,b as B,ae as T,z as K,Y as z,y as A}from"./vendor.1c8b4573.js";import{m as $}from"./index.ec15dc7d.js";import{_ as H}from"./lodash.0a1ccad5.js";import{G as R}from"./package.enum.de4ee89f.js";import{u as J}from"./useGuardStudent.237f12b5.js";import{_ as Q}from"./VLoader.vue_vue&type=script&setup=true&lang.a96d7daf.js";import{u as W}from"./useStudentApi.e8de2a80.js";import{u as X}from"./useNotyf.ddf08f06.js";import"./useOptionApi.f4dc99b9.js";import"./quiz.enum.fc8b95fc.js";f("data-v-1d7683ea");const Z={class:"account-box is-form is-footerless"},ee=M("Confirm"),le=M("Cancel"),ae={class:"form-head-inner"},te={class:"left"},se=V("h3",null,"Globish Plus Management",-1),ne={key:0,class:"right"},ie={class:"buttons"},oe=M(" Cancel "),ue=M(" Save Changes "),de={class:"buttons"},re=M(" Edit "),ce={key:1,class:"right"},pe={key:0,class:"buttons"},ve=M(" Activate "),fe={class:"form-body"},me={class:"fieldset"},he=V("div",{class:"fieldset-heading"},[V("h4",null,"Student Info"),V("p",null,"Information of student")],-1),ye={class:"columns is-multiline"},be={class:"column is-6"},ge=V("label",null,"First name",-1),xe={class:"column is-6"},ke=V("label",null,"Last name",-1),Ie={class:"column is-6"},_e=V("label",null,"Nickname",-1),Ge={class:"column is-6"},De=V("label",null,"Email",-1),Ve={class:"column is-12"},Pe=V("label",null,"Globish Level",-1),Se={class:"multiselect-single-label"},je={class:"select-option-text"},Le={class:"fieldset"},Oe=V("div",{class:"fieldset-heading"},[V("h4",null,"Globish Plus Info"),V("p",null,"Information of Globish Plus (Voxy)")],-1),Ye={class:"columns is-multiline"},Ce={class:"column is-12"},Ue=V("label",null,"First name",-1),Ee=["readonly"],we={class:"column is-12"},Fe=V("label",null,"Last name",-1),Me=["readonly"],Ne={class:"column is-12"},qe=V("label",null,"Email",-1),Be=["readonly"],Te={key:0,class:"column is-12"},Ke=V("label",null,"Globish Plus Ticket",-1),ze={class:"multiselect-single-label"},Ae={class:"select-option-text"},$e={key:1,class:"column is-12"},He=V("label",null,"Globish Level",-1),Re={class:"text-danger"},Je=[V("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:alert-triangle"},null,-1),M("    Level Not Match! ")],Qe={class:"multiselect-single-label"},We={class:"select-option-text"},Xe={key:2,class:"column is-12"},Ze=V("label",null,"Group Globish Plus",-1),el={key:3,class:"column is-12"},ll=V("label",null,"Expire Date",-1),al=["value","readonly"],tl={key:0,class:"fieldset"},sl=V("div",{class:"fieldset-heading"},[V("h4",null,"Ticket Info"),V("p",null,"Information of ticket")],-1),nl={class:"table is-fullwidth table-size"},il=V("thead",null,[V("tr",null,[V("th",{scope:"col"},"Ticket ID"),V("th",{scope:"col",class:"has-text-centered"},"Package Item ID"),V("th",{scope:"col",class:"has-text-centered"},"Feature Group ID"),V("th",{scope:"col",class:"has-text-centered"},"Globish Level"),V("th",{scope:"col",class:"has-text-centered"},"Package Name"),V("th",{scope:"col",class:"has-text-centered"},"Start Date"),V("th",{scope:"col",class:"has-text-centered"},"Expire Date")])],-1),ol={class:"has-text-centered"},ul={class:"has-text-centered"},dl={class:"has-text-centered"},rl={class:"has-text-centered"},cl={class:"has-text-centered"},pl={class:"has-text-centered"},vl={class:"has-text-centered"},fl=V("div",{class:"content"},[V("blockquote",{class:"is-primary"},[V("p",{class:"has-text-warning"},[V("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:alert-triangle"}),M('    Before "Save", please make sure the expiration date to be equal to the expiration date of the ticket. ')])])],-1);m();var ml=h({props:{studentInfo:{type:Object,required:!0,default:()=>{}},studentGbpInfo:{type:Object,required:!0,default:()=>{}},validation:{type:Object,default:()=>{}},voxyData:{type:Object,required:!0,default:()=>{}},isStudentVoxy:{type:Boolean,required:!0,default:!1}},emits:["on-update","on-create"],setup(e,{emit:l}){var a,t,s,n,i,d,f,m,h,M,N,q,B,T,K,z,A,Q,W;const X=e,{globishPlus:ml}=J(),hl=Object.keys(R).map((e=>({key:e,value:R[e]}))),{y:yl}=y(),bl=b((()=>yl.value>50)),gl=g(!1),xl=g(!1),kl=g(!1),Il=g(void 0),_l=g(X.voxyData&&H.cloneDeep(X.voxyData)||{firstname:(null==(t=null==(a=X.studentInfo)?void 0:a.nickname)?void 0:t.en)&&(null==(n=null==(s=X.studentInfo)?void 0:s.firstname)?void 0:n.en)?`${null==(d=null==(i=X.studentInfo)?void 0:i.nickname)?void 0:d.en} ${null==(m=null==(f=X.studentInfo)?void 0:f.firstname)?void 0:m.en}`:(null==(M=null==(h=X.studentInfo)?void 0:h.firstname)?void 0:M.en)||"default",lastname:(null==(q=null==(N=X.studentInfo)?void 0:N.lastname)?void 0:q.en)||"default",email:null==(B=X.studentInfo)?void 0:B.email}),Gl=g(X.validation),Dl=g(null==(T=X.studentGbpInfo)?void 0:T.globishLevel),Vl=g((null==(K=X.studentGbpInfo)?void 0:K.tickets)||[]),Pl=g((null==(A=null==(z=X.voxyData)?void 0:z.featureGroup)?void 0:A.id)?H.cloneDeep(null==(W=null==(Q=X.voxyData)?void 0:Q.featureGroup)?void 0:W.id):void 0);x((()=>X.validation),(()=>Gl.value=X.validation));const Sl=async()=>{xl.value=!0;const{value:e}=_l,a={firstname:null==e?void 0:e.firstname,lastname:null==e?void 0:e.lastname,email:null==e?void 0:e.email,expireDate:null==e?void 0:e.expireDate,globishLevel:+(null==e?void 0:e.globishLevel),featureGroupId:Pl.value};l("on-update",a),xl.value=!1},jl=async()=>{xl.value=!0;const{value:e}=_l,a={firstname:null==e?void 0:e.firstname,lastname:null==e?void 0:e.lastname,email:null==e?void 0:e.email,ticketId:Il.value};l("on-create",a),xl.value=!1,Ol()},Ll=()=>{gl.value=!1,_l.value=H.cloneDeep(X.voxyData),Gl.value={}},Ol=()=>{kl.value=!kl.value},Yl=e=>{delete Gl.value[e]};return(l,a)=>{const t=o,s=u,n=r,i=c,d=p,f=k("Multiselect"),m=v,h=k("v-date-picker");return I(),_("div",Z,[G(n,{title:"Confirm activate Globish Plus",open:kl.value,size:"small",actions:"center",onClose:Ol},{content:D((()=>[G(t,{title:"Please make sure you filled student's information completely before press confirm button to activate voxy account"})])),action:D((()=>[G(s,{color:"primary",raised:"",onClick:jl},{default:D((()=>[ee])),_:1})])),cancel:D((()=>[G(s,{raised:"",onClick:Ol},{default:D((()=>[le])),_:1})])),_:1},8,["open"]),V("div",{class:Y(["form-head stuck-header",[S(bl)&&"is-stuck"]])},[V("div",ae,[V("div",te,[se,V("p",null,P(e.isStudentVoxy?"Edit student's Globish Plus information":"Register new student's Globish Plus"),1)]),e.isStudentVoxy&&S(ml).canEdit?(I(),_("div",ne,[j(V("div",ie,[G(s,{icon:"lnir lnir-arrow-left rem-100",light:"","dark-outlined":"",onClick:Ll},{default:D((()=>[oe])),_:1}),G(s,{color:"primary",raised:"",loading:xl.value,onClick:Sl},{default:D((()=>[ue])),_:1},8,["loading"])],512),[[L,gl.value]]),j(V("div",de,[G(s,{color:"primary",raised:"",onClick:a[0]||(a[0]=e=>gl.value=!0)},{default:D((()=>[re])),_:1})],512),[[L,!gl.value]])])):(I(),_("div",ce,[S(ml).canCreate?(I(),_("div",pe,[G(s,{color:"primary",raised:"",loading:xl.value,onClick:Ol},{default:D((()=>[ve])),_:1},8,["loading"])])):O("",!0)]))])],2),V("div",fe,[V("div",me,[he,V("div",ye,[V("div",be,[G(d,null,{default:D((()=>[ge,G(i,{icon:"feather:user"},{default:D((()=>[j(V("input",{"onUpdate:modelValue":a[1]||(a[1]=l=>e.studentInfo.firstname.en=l),type:"text",class:"input",placeholder:"First Name",disabled:""},null,512),[[C,e.studentInfo.firstname.en]])])),_:1})])),_:1})]),V("div",xe,[G(d,null,{default:D((()=>[ke,G(i,{icon:"feather:user"},{default:D((()=>[j(V("input",{"onUpdate:modelValue":a[2]||(a[2]=l=>e.studentInfo.lastname.en=l),type:"text",class:"input",placeholder:"Last Name",disabled:""},null,512),[[C,e.studentInfo.lastname.en]])])),_:1})])),_:1})]),V("div",Ie,[G(d,null,{default:D((()=>[_e,G(i,{icon:"feather:user"},{default:D((()=>[j(V("input",{"onUpdate:modelValue":a[3]||(a[3]=l=>e.studentInfo.nickname.en=l),type:"text",class:"input",placeholder:"Nickname",disabled:""},null,512),[[C,e.studentInfo.nickname.en]])])),_:1})])),_:1})]),V("div",Ge,[G(d,null,{default:D((()=>[De,G(i,{icon:"feather:at-sign"},{default:D((()=>[j(V("input",{"onUpdate:modelValue":a[4]||(a[4]=l=>e.studentInfo.email=l),type:"text",class:"input",placeholder:"Email",disabled:""},null,512),[[C,e.studentInfo.email]])])),_:1})])),_:1})]),V("div",Ve,[G(d,null,{default:D((()=>[Pe,G(i,null,{default:D((()=>[G(f,{modelValue:Dl.value,"onUpdate:modelValue":a[5]||(a[5]=e=>Dl.value=e),"track-by":"key","value-prop":"value",disabled:"",options:S(hl)},{singlelabel:D((({value:e})=>[V("div",Se,P(e.key||"-"),1)])),option:D((({option:e})=>[V("span",je,P(e.key),1)])),_:1},8,["modelValue","options"])])),_:1})])),_:1})])])]),V("div",Le,[Oe,V("div",Ye,[V("div",Ce,[G(d,null,{default:D((()=>[Ue,G(i,{icon:"feather:user"},{default:D((()=>[j(V("input",{"onUpdate:modelValue":a[6]||(a[6]=e=>_l.value.firstname=e),type:"text",class:"input",placeholder:"First Name",readonly:!gl.value&&e.isStudentVoxy,onKeypress:a[7]||(a[7]=e=>Yl("firstname"))},null,40,Ee),[[C,_l.value.firstname]])])),_:1}),j(V("p",{class:"help has-text-danger"},P(Gl.value.firstname),513),[[L,Gl.value.firstname]])])),_:1})]),V("div",we,[G(d,null,{default:D((()=>[Fe,G(i,{icon:"feather:user"},{default:D((()=>[j(V("input",{"onUpdate:modelValue":a[8]||(a[8]=e=>_l.value.lastname=e),type:"text",class:"input",placeholder:"Last Name",readonly:!gl.value&&e.isStudentVoxy,onKeypress:a[9]||(a[9]=e=>Yl("lastname"))},null,40,Me),[[C,_l.value.lastname]]),j(V("p",{class:"help has-text-danger"},P(Gl.value.lastname),513),[[L,Gl.value.lastname]])])),_:1})])),_:1})]),V("div",Ne,[G(d,null,{default:D((()=>[qe,G(i,{icon:"feather:at-sign"},{default:D((()=>[j(V("input",{"onUpdate:modelValue":a[10]||(a[10]=e=>_l.value.email=e),type:"text",class:"input",placeholder:"Email",readonly:!gl.value&&e.isStudentVoxy,onKeypress:a[11]||(a[11]=e=>Yl("email"))},null,40,Be),[[C,_l.value.email]]),j(V("p",{class:"help has-text-danger"},P(Gl.value.email),513),[[L,Gl.value.email]])])),_:1})])),_:1})]),e.isStudentVoxy?O("",!0):(I(),_("div",Te,[G(d,null,{default:D((()=>[Ke,G(i,null,{default:D((()=>[G(f,{modelValue:Il.value,"onUpdate:modelValue":a[12]||(a[12]=e=>Il.value=e),placeholder:"Select Globish Plus Ticket","value-prop":"id",searchable:!1,options:Vl.value,onKeypress:a[13]||(a[13]=e=>Yl("ticketId"))},{singlelabel:D((({value:e})=>[V("div",ze," (Ticket ID: "+P(e.id)+") "+P(e.packageId)+"-"+P(e.packageName)+" (Feature Group ID: "+P(e.featureGroupId)+") ",1)])),option:D((({option:e})=>[V("span",Ae," (Ticket ID: "+P(e.id)+") "+P(e.packageId)+"-"+P(e.packageName)+" (Feature Group ID: "+P(e.featureGroupId)+") ",1)])),_:1},8,["modelValue","options"]),j(V("p",{class:"help has-text-danger"},P(Gl.value.ticketId),513),[[L,Gl.value.ticketId]])])),_:1})])),_:1})])),e.isStudentVoxy?(I(),_("div",$e,[G(d,null,{default:D((()=>[He,j(V("p",Re,Je,512),[[L,_l.value.globishLevel!=Dl.value]]),G(i,null,{default:D((()=>[G(f,{modelValue:_l.value.globishLevel,"onUpdate:modelValue":a[14]||(a[14]=e=>_l.value.globishLevel=e),placeholder:"Select globish level","track-by":"key","value-prop":"value",disabled:!gl.value,searchable:!0,options:S(hl),onKeypress:a[15]||(a[15]=e=>Yl("globishLevel"))},{singlelabel:D((({value:e})=>[V("div",Qe,P(e.key),1)])),option:D((({option:e})=>[V("span",We,P(e.key),1)])),_:1},8,["modelValue","disabled","options"]),j(V("p",{class:"help has-text-danger"},P(Gl.value.globishLevel),513),[[L,Gl.value.globishLevel]])])),_:1})])),_:1})])):O("",!0),e.isStudentVoxy?(I(),_("div",Xe,[G(d,null,{default:D((()=>[Ze,G(i,null,{default:D((()=>[G(m,{modelValue:Pl.value,"onUpdate:modelValue":a[16]||(a[16]=e=>Pl.value=e),disabled:!gl.value,"onClear:validate":a[17]||(a[17]=e=>Yl("featureGroupId"))},null,8,["modelValue","disabled"]),j(V("p",{class:"help has-text-danger"},P(Gl.value.featureGroupId),513),[[L,Gl.value.featureGroupId]])])),_:1})])),_:1})])):O("",!0),e.isStudentVoxy?(I(),_("div",el,[G(h,{modelValue:_l.value.expireDate,"onUpdate:modelValue":a[19]||(a[19]=e=>_l.value.expireDate=e),color:"orange","model-config":{type:"string",mask:"YYYY-MM-DD"},masks:{input:"DD/MM/YYYY"},"trim-weeks":"",popover:{visibility:gl.value?"click":""}},{default:D((({inputValue:e,inputEvents:l})=>[G(d,null,{default:D((()=>[ll,G(i,{icon:"feather:calendar"},{default:D((()=>[V("input",U({class:"input",type:"text",placeholder:"Expire Date",value:e,readonly:!gl.value},E(l),{onChange:a[18]||(a[18]=e=>Yl("expireDate"))}),null,16,al)])),_:2},1024),j(V("p",{class:"help has-text-danger"},P(Gl.value.expireDate),513),[[L,Gl.value.expireDate]])])),_:2},1024)])),_:1},8,["modelValue","popover"])])):O("",!0)]),e.isStudentVoxy?(I(),_("div",tl,[sl,V("table",nl,[il,V("tbody",null,[(I(!0),_(w,null,F(Vl.value,((e,l)=>(I(),_("tr",{key:`ticket-${l}`},[V("td",ol,P(null==e?void 0:e.id),1),V("td",ul,P(null==e?void 0:e.packageItemId),1),V("td",dl,P(null==e?void 0:e.featureGroupId),1),V("td",rl,P(Object.keys(S(R)).find((l=>S(R)[l]==(null==e?void 0:e.globishLevel)))||"-"),1),V("td",cl," ("+P(e.packageId)+") "+P(null==e?void 0:e.packageName),1),V("td",pl,P((null==e?void 0:e.startDate)&&S($)(null==e?void 0:e.startDate).format("DD/MM/YYYY")||"-"),1),V("td",vl,P((null==e?void 0:e.expireDate)&&S($)(null==e?void 0:e.expireDate).format("DD/MM/YYYY")||"-"),1)])))),128))])]),fl])):O("",!0)])])])}}});function hl(){const e=N({isLoading:!1,studentGlobishPlus:void 0,validation:{}}),o=q(),u=X(),r=B(),{getStudentGlobishPlusById:c,updateStudentGlobishPlusById:p,registerStudentGlobishPlusById:v}=W();return f=((e,l)=>{for(var a in l||(l={}))s.call(l,a)&&i(e,a,l[a]);if(t)for(var a of t(l))n.call(l,a)&&i(e,a,l[a]);return e})({},T(e)),l(f,a({fetchStudentGlobishPlusById:async()=>{const l=o.params.id;if(!l)return;e.isLoading=!0;const a=await c(+l);e.isLoading=!1,a&&(e.studentGlobishPlus=a)},updateStudentGlobishPlusProfile:async l=>{const a=o.params.id,{status:t,message:s}=await p(+a,l);200===t||201===t?(u.success("Your changes have been successfully saved!"),r.go(0)):("object"==typeof s&&(e.validation=s),u.error(d(s)||"Fail! Please try again"))},registerStudentGlobishPlus:async l=>{const a=o.params.id;e.isLoading=!0;const{message:t,status:s}=await v(+a,l);201===s||200===s?(u.success("Your registered successfully!"),r.go(0)):("object"==typeof t&&(e.validation=t),u.error(d(t)||"Fail! Please try again")),e.isLoading=!1}}));var f}ml.__scopeId="data-v-1d7683ea";var yl=h({setup(e){const{updateStudentGlobishPlusProfile:l,fetchStudentGlobishPlusById:a,validation:t,studentGlobishPlus:s,registerStudentGlobishPlus:n,isLoading:i}=hl(),o=K("studentInfo");return z((()=>{a()})),(e,a)=>{const u=ml,d=Q;return I(),A(d,{size:"large",translucent:"",active:S(i)},{default:D((()=>{var e,a;return[S(s)?(I(),A(u,{key:0,"is-student-voxy":!!(null==(e=S(s))?void 0:e.voxyInfo),"voxy-data":null==(a=S(s))?void 0:a.voxyInfo,"student-info":S(o),"student-gbp-info":S(s),validation:S(t),onOnUpdate:S(l),onOnCreate:S(n)},null,8,["is-student-voxy","voxy-data","student-info","student-gbp-info","validation","onOnUpdate","onOnCreate"])):O("",!0)]})),_:1},8,["active"])}}});export default yl;
