var e,t,a,l,n=Object.defineProperty,s=Object.defineProperties,i=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,r=(e,t,a)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;import{_ as c}from"./VRadio.89eaf975.js";import{_ as p,a as m}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{c as g,e as v,h as f}from"./index.d7dc1ff6.js";import{_ as h}from"./VModal.31b4f4ba.js";import{d as C,r as D,E as b,o as y,e as k,x as S,F as O,h as Y,H as M,I as E,y as I,g as _,K as j,V as P,t as V,ao as x,ap as w,i as T,G as L,ai as U,q as N,A,b as $,D as B,Y as q,p as F,a as H}from"./vendor.1c8b4573.js";import{c as G}from"./text.helper.174bd8fa.js";import{_ as R}from"./VTag.vue_vue&type=script&setup=true&lang.b31af8ee.js";import{_ as z}from"./Datatable.aae3ef08.js";import{_ as K}from"./CollapseContent.552f3f62.js";import{_ as J}from"./VPlaceholderSection.vue_vue&type=script&setup=true&lang.35b0ad2a.js";import{_ as Q,a as W}from"./search-4-dark.fb3880a5.js";import{u as X}from"./useGuardStudent.237f12b5.js";import{t as Z}from"./reactivity.esm-bundler.07132181.js";import{u as ee}from"./useStudentApi.e8de2a80.js";import{u as te}from"./useNotyf.ddf08f06.js";import{t as ae}from"./date.helper.6ae3fc87.js";import"./VLoader.vue_vue&type=script&setup=true&lang.a96d7daf.js";import"./VFlexPagination.86ce707c.js";import"./usePaginationRoute.780ca235.js";import"./index.ec15dc7d.js";import"./lodash.0a1ccad5.js";(t=e||(e={})).INACTIVE="inactive",t.ACTIVE="active",t.COMPLETE="complete",t.INCOMPLETE="incomplete",(l=a||(a={})).COMPLETE="complete",l.INCOMPLETE="incomplete";const le={key:0},ne={class:"m-4"},se=Y("label",null,"Status",-1),ie=Y("label",null,"Complete Date",-1),oe=["value"],de=L("Save");var ue=C({props:{open:{type:Boolean,default:!1},title:{type:String,default:"Update challenge"},info:{type:Object,required:!0},validate:{type:Object,default:void 0},loading:{type:Boolean,default:!1}},emits:["on-submit","on-close"],setup(t,{emit:a}){const l=t,n=D(Object.values(e)),s=()=>{a("on-submit",l.info)};return(e,l)=>{const i=c,o=p,d=m,u=p,r=m,v=b("v-date-picker"),f=g,C=h;return t.info?(y(),k("div",le,[S(C,{open:t.open,title:t.title,size:"medium",actions:"center",onClose:l[1]||(l[1]=e=>a("on-close"))},{content:O((()=>[Y("div",ne,[S(d,null,{default:O((()=>[se,S(o,null,{default:O((()=>[(y(!0),k(M,null,E(n.value,(e=>(y(),I(i,{key:e,modelValue:t.info.status,"onUpdate:modelValue":e=>t.info.status=e,value:e,label:_(G)(e),name:"status",color:"primary"},null,8,["modelValue","onUpdate:modelValue","value","label"])))),128))])),_:1}),j(Y("div",{class:"help is-danger"},V(t.validate.status),513),[[P,t.validate.status]])])),_:1}),S(v,{modelValue:t.info.completeDate,"onUpdate:modelValue":l[0]||(l[0]=e=>t.info.completeDate=e),color:"orange","model-config":{type:"date",mask:"DD/MM/YYYY"},masks:{input:"DD/MM/YYYY"},popover:{visibility:"click"}},{default:O((({inputValue:e,inputEvents:t})=>[S(r,null,{default:O((()=>[ie,S(u,{icon:"feather:calendar"},{default:O((()=>[Y("input",x({class:"input",type:"text",placeholder:"Complete Date",value:e},w(t)),null,16,oe)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"]),j(Y("div",{class:"help is-danger"},V(t.validate.completeDate),513),[[P,t.validate.completeDate]])])])),action:O((()=>[S(f,{color:"primary",loading:t.loading,onClick:s},{default:O((()=>[de])),_:1},8,["loading"])])),_:1},8,["open","title"])])):T("",!0)}}});const re={key:0},ce={class:"m-4"},pe=Y("label",null,"Start date",-1),me=["value"],ge=Y("label",null,"End date",-1),ve=["value"],fe=Y("label",null,"Extra Point",-1),he=L("Save");var Ce=C({props:{open:{type:Boolean,default:!1},info:{type:Object,required:!0},validate:{type:Object,default:void 0},title:{type:String,default:"Update challenge milestone"},loading:{type:Boolean,default:!0}},emits:["on-submit","on-close"],setup(e,{emit:t}){const a=e,l=e=>{e<0&&(a.info.extraPoint=0)},n=()=>{t("on-submit",a.info)};return(a,s)=>{const i=p,o=m,d=b("v-date-picker"),u=p,r=m,c=g,v=h;return e.info?(y(),k("div",re,[S(v,{open:e.open,title:e.title,actions:"right",onClose:s[3]||(s[3]=e=>t("on-close"))},{content:O((()=>[Y("div",ce,[S(d,{modelValue:e.info.startDate,"onUpdate:modelValue":s[0]||(s[0]=t=>e.info.startDate=t),color:"orange","model-config":{type:"date",mask:"DD/MM/YYYY"},masks:{input:"DD/MM/YYYY"},popover:{visibility:"click"}},{default:O((({inputValue:e,inputEvents:t})=>[S(o,null,{default:O((()=>[pe,S(i,{icon:"feather:calendar"},{default:O((()=>[Y("input",x({class:"input",type:"text",placeholder:"Ticket Start Date",value:e},w(t)),null,16,me)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"]),j(Y("div",{class:"help is-danger"},V(e.validate.startDate),513),[[P,e.validate.startDate]]),S(d,{modelValue:e.info.endDate,"onUpdate:modelValue":s[1]||(s[1]=t=>e.info.endDate=t),color:"orange","model-config":{type:"date",mask:"DD/MM/YYYY"},masks:{input:"DD/MM/YYYY"},popover:{visibility:"click"}},{default:O((({inputValue:e,inputEvents:t})=>[S(o,null,{default:O((()=>[ge,S(i,{icon:"feather:calendar"},{default:O((()=>[Y("input",x({class:"input",type:"text",placeholder:"Ticket Start Date",value:e},w(t)),null,16,ve)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"]),j(Y("div",{class:"help is-danger"},V(e.validate.endDate),513),[[P,e.validate.endDate]]),S(r,null,{default:O((()=>[fe,S(u,null,{default:O((()=>[j(Y("input",{"onUpdate:modelValue":[s[2]||(s[2]=t=>e.info.extraPoint=t),l],type:"number",min:0,class:"input is-primary-focus",placeholder:"Extra Point"},null,512),[[U,e.info.extraPoint]])])),_:1}),j(Y("div",{class:"help is-danger"},V(e.validate.extraPoint),513),[[P,e.validate.extraPoint]])])),_:1})])])),action:O((()=>[S(c,{color:"primary",loading:e.loading,onClick:n},{default:O((()=>[he])),_:1},8,["loading"])])),_:1},8,["open","title"])])):T("",!0)}}});function De(){const e=N({challengeData:[],isLoading:!1,isOpenChallenge:!1,currentChallengeMilestoneId:0,isOpenChallengeStatus:!1,currentChallengStudentId:0,validate:{}}),t=A();$();const a=te(),l=t.params.id,{getStudentChallengeById:n,updateStudentChallengeMilestone:c,updateStudentChallengeStatus:p}=ee(),m=D({studentId:0,startDate:null,endDate:null,extraPoint:0}),g=D({studentId:0,status:void 0,completeDate:void 0}),f=D(),h=D(),C=async()=>{e.isLoading=!0;const t=await n(+l);e.challengeData=t.data,e.isLoading=!1};return b=((e,t)=>{for(var a in t||(t={}))d.call(t,a)&&r(e,a,t[a]);if(o)for(var a of o(t))u.call(t,a)&&r(e,a,t[a]);return e})({},Z(e)),s(b,i({fetchStudentChallenge:C,challengeMilestoneHeader:[{key:"idx",label:"Index"},{key:"name",label:"Challenge Name"},{key:"startDate",label:"Start date"},{key:"endDate",label:"End date"},{key:"completeDate",label:"Complete date"},{key:"nTicket",label:"Total ticket",isCenter:!0},{key:"ticketUsed",label:"Used ticket",isCenter:!0},{key:"completeClass",label:"Complete Class",isCenter:!0},{key:"status",label:"Status",isCenter:!0},{key:"extraPoint",label:"Extra point",isCenter:!0}],editChallenge:async t=>{e.isLoading=!0;const l=await c({studentId:t.studentId,startDate:t.startDate,endDate:t.endDate,extraPoint:t.extraPoint?t.extraPoint:0},e.currentChallengeMilestoneId);200===l.status?(a.success("success!"),e.validate={},e.isOpenChallenge=!1,C()):"object"==typeof l.message?e.validate=l.message:a.error(v(l.message)),e.isLoading=!1},editStudentChallenge:async t=>{e.isLoading=!0;const l=await p({studentId:t.studentId,completeDate:t.completeDate?t.completeDate:null,status:t.status},e.currentChallengStudentId);200===l.status?(a.success("success!"),e.validate={},e.isOpenChallengeStatus=!1,C()):"object"==typeof l.message?e.validate=l.message:a.error(v(l.message)),e.isLoading=!1},studentId:l,openChallengeStatus:t=>{var a,n;g.value={studentId:+l,status:t.status,completeDate:t.completeDate?new Date(B(t.completeDate).toISOString()):t.completeDate},e.currentChallengStudentId=t.id,h.value=`${null==(a=t.challenge)?void 0:a.name}: ${null==(n=t.series)?void 0:n.name} `,e.isOpenChallengeStatus=!0},closeEditStudentChallenge:()=>{g.value={studentId:0,status:void 0,completeDate:void 0},h.value=void 0,e.isOpenChallengeStatus=!1},openEditChallenge:t=>{m.value={studentId:+l,startDate:t.startDate?new Date(B(t.startDate).toISOString()):t.startDate,endDate:t.endDate?new Date(B(t.endDate).toISOString()):t.endDate,extraPoint:t.extraPoint},e.currentChallengeMilestoneId=t.id,f.value=t.name,e.isOpenChallenge=!0},closeEditChallenge:()=>{m.value={studentId:0,startDate:null,endDate:null,extraPoint:0},f.value=void 0,e.isOpenChallenge=!1},studentChallenge:m,studentChallengeStatus:g,challengeMilestoneName:f,studentChallengeName:h}));var b}F("data-v-9d22876a");const be={class:"account-box"},ye={key:0},ke={class:"is-flex is-justify-content-space-between is-align-items-center"},Se=L(" Edit "),Oe={key:1},Ye=L("Actions"),Me=["onClick"],Ee=[Y("div",{class:"icon"},[Y("i",{class:"lnir lnir-pencil","aria-hidden":"true"})],-1),Y("div",{class:"meta"},[Y("span",null,"Update Challenge"),Y("span",null,"update challenge milestone")],-1)],Ie=Y("img",{class:"light-image",src:Q,alt:"light-empty"},null,-1),_e=Y("img",{class:"dark-image",src:W,alt:"dark-empty"},null,-1);H();var je=C({setup(t){const{fetchStudentChallenge:l,challengeData:n,challengeMilestoneHeader:s,isLoading:i,studentId:o,validate:d,openChallengeStatus:u,closeEditStudentChallenge:r,editStudentChallenge:c,studentChallengeStatus:p,isOpenChallengeStatus:m,currentChallengStudentId:v,studentChallengeName:h,openEditChallenge:C,closeEditChallenge:D,editChallenge:b,studentChallenge:j,isOpenChallenge:P,currentChallengeMilestoneId:x,challengeMilestoneName:w}=De(),{studentChallenge:U}=X(),N=t=>{switch(t){case e.INACTIVE:return"warning";case e.ACTIVE:return"info";case e.COMPLETE:return"success";case e.INCOMPLETE:return"danger"}};return q((()=>{l()})),(t,l)=>{var o;const v=ue,x=Ce,A=R,$=g,B=g,q=f,F=z,H=K,Q=J;return y(),k("div",be,[S(v,{open:_(m),info:_(p),validate:_(d),title:`Update challenge [${_(h)}]`,loading:_(i),onOnClose:_(r),onOnSubmit:_(c)},null,8,["open","info","validate","title","loading","onOnClose","onOnSubmit"]),S(x,{open:_(P)&&!!_(j),info:_(j),validate:_(d),title:`Update challenge milestone [${_(w)}]`,loading:_(i),onOnClose:_(D),onOnSubmit:_(b)},null,8,["open","info","validate","title","loading","onOnClose","onOnSubmit"]),(null==(o=_(n))?void 0:o.length)>0?(y(),k("div",ye,[(y(!0),k(M,null,E(_(n),(t=>{var l,n;return y(),k("div",{key:t.id},[S(H,{"with-chevron":"",title:`[${t.challenge.name}] ${(null==(l=t.series)?void 0:l.name)?null==(n=t.series)?void 0:n.name:""}`,open:t.status===_(e).ACTIVE},{"collapse-status":O((()=>[S(A,{class:"ml-4",label:_(G)(t.status),color:N(t.status)},null,8,["label","color"])])),"collapse-content":O((()=>[Y("div",ke,[S(A,{class:"date-tag",label:`Complete Date: ${t.completeDate?_(ae)(t.completeDate,"DD/MM/YYYY"):"-"}`,color:"solid"},null,8,["label"]),_(U).canEditStatus?(y(),I($,{key:0,class:"edit-button",color:"primary",outlined:"",onClick:e=>_(u)(t)},{default:O((()=>[Se])),_:2},1032,["onClick"])):T("",!0)]),S(F,{data:t.challengeMilestone,headers:_(s),"is-loading":_(i),"can-searchable":!1,"hide-pagination":"","hide-per-page":"","show-item-of-entires":!1,"hide-footer":!0,"is-action":_(U).canEditChallengeMilestone},{startDate:O((({value:e})=>[L(V(e?_(ae)(e,"DD/MM/YYYY"):"-"),1)])),endDate:O((({value:e})=>[L(V(e?_(ae)(e,"DD/MM/YYYY"):"-"),1)])),completeDate:O((({value:e})=>[L(V(e?_(ae)(e,"DD/MM/YYYY"):"-"),1)])),status:O((({value:e})=>[e?(y(),I(A,{key:0,class:"ml-4",label:_(G)(e),color:e===_(a).COMPLETE?"success":"danger"},null,8,["label","color"])):(y(),k("p",Oe,"-"))])),action:O((({value:e})=>[S(q,{spaced:"",right:""},{button:O((({toggle:e})=>[S(B,{icon:"feather:more-vertical",class:"is-trigger",onClick:e},{default:O((()=>[Ye])),_:2},1032,["onClick"])])),content:O((()=>[_(U).canEditChallengeMilestone?(y(),k("a",{key:0,role:"menuitem",class:"dropdown-item is-media",onClick:t=>_(C)(e)},Ee,8,Me)):T("",!0)])),_:2},1024)])),_:2},1032,["data","headers","is-loading","is-action"])])),_:2},1032,["title","open"])])})),128))])):(y(),I(Q,{key:1,title:"No data to show",subtitle:"There is currently no data to show in this list."},{image:O((()=>[Ie,_e])),_:1}))])}}});je.__scopeId="data-v-9d22876a";export default je;
