var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,o=(e,t)=>{for(var a in t||(t={}))i.call(t,a)&&s(e,a,t[a]);if(n)for(var a of n(t))l.call(t,a)&&s(e,a,t[a]);return e},r=(e,n)=>t(e,a(n));import{A as u,O as d,_ as c}from"./ModalOrientationEditor.5e2952bc.js";import{_ as p,a as v}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{g as m,e as g,u as f,p as y,j as k,c as b,h as O}from"./index.d7dc1ff6.js";import{_ as h}from"./VTag.vue_vue&type=script&setup=true&lang.b31af8ee.js";import{_ as I}from"./Datatable.aae3ef08.js";import{q as D,A as S,b as _,Y as C,ae as j,D as w,k as E,d as Y,X as N,r as V,E as P,o as T,e as A,x as R,g as M,au as F,F as q,h as x,i as $,K as L,ak as W,O as H,V as G,ao as U,ap as B,y as K,t as z,G as X,p as J,a as Q}from"./vendor.1c8b4573.js";import{u as Z}from"./useOrientationApi.ffb22b41.js";import{u as ee}from"./usePaginationRoute.780ca235.js";import{u as te}from"./useNotyf.ddf08f06.js";import{t as ae}from"./date.helper.6ae3fc87.js";import"./SelectOption.vue_vue&type=script&setup=true&lang.934e0be4.js";import"./index.8f8d8101.js";import"./VModal.31b4f4ba.js";import"./useOptionApi.f4dc99b9.js";import"./quiz.enum.fc8b95fc.js";import"./student.helper.13430dac.js";import"./student.enum.ad6af513.js";import"./VPlaceholderSection.vue_vue&type=script&setup=true&lang.35b0ad2a.js";import"./VLoader.vue_vue&type=script&setup=true&lang.a96d7daf.js";import"./VFlexPagination.86ce707c.js";import"./search-4-dark.fb3880a5.js";import"./index.ec15dc7d.js";import"./lodash.0a1ccad5.js";function ne(){var e;const{user:t}=m(),a=D({data:[],total:0,isLoading:!0,filterStatus:void 0,filterCountry:void 0,range:{start:"",end:""},canSelectCountry:((null==(e=null==t?void 0:t.manageCountry)?void 0:e.length)||0)>1,validation:{}}),n=S(),i=_(),l=te(),{currentPage:s,perPage:u,search:d}=ee(),{getOrientations:c,createOrientation:p,updateOrientation:v}=Z();C((()=>{(async()=>{a.isLoading=!0,a.filterStatus=n.query.status,a.filterCountry=n.query.country,a.range.start=n.query.startDate,a.range.end=n.query.endDate;const e=await c({currentPage:s,perPage:u,search:d,status:a.filterStatus,country:a.filterCountry,startDate:w(a.range.start,"YYYY-MM-DD").toISOString(),endDate:w(a.range.end,"YYYY-MM-DD").toISOString()});e&&(a.data=e.data,a.total=e.total),a.isLoading=!1})()}));return r(o({},j(a)),{orientTableHeaders:[{key:"id",label:"ID"},{key:"appointStatus",label:"Appoint Status"},{key:"operator",label:"Operator",isRaw:!0},{key:"package",label:"Package",isRaw:!0},{key:"student",label:"Student",isRaw:!0},{key:"date",label:"Date",isRaw:!0},{key:"time",label:"Time",isRaw:!0},{key:"orientedStatus",label:"Orient Status"}],selectFilterStatus:()=>{i.push({name:"students-orientations",query:{status:a.filterStatus,country:n.query.country}})},selectFilterCountry:()=>{i.push({name:"students-orientations",query:{status:n.query.status,country:a.filterCountry}})},adminCreateOrientation:async e=>{a.isLoading=!0;const{data:t,message:n}=await p(e);t?(l.success("Your created successfully!"),i.go(0)):("object"==typeof n&&(a.validation=n),l.error(g(n)||"Fail! Please try again")),a.isLoading=!1},adminEditOrientation:async(e,t)=>{a.isLoading=!0;const{data:n,message:s}=await v(e,t);n?(l.success("Your changes have been successfully saved!"),i.go(0)):("object"==typeof s&&(a.validation=s),l.error(g(s)||"Fail! Please try again")),a.isLoading=!1},onFilterDate:()=>{if(!a.range.start||a.range.end)if(!a.range.end||a.range.start)if(w(a.range.start)>w(a.range.end)){const e={startDate:"Please select start date less than end date",endDate:" "};a.validation=e}else a.range.start&&a.range.end?a.validation={}:(a.validation={},a.range.start=void 0,a.range.end=void 0),i.push({name:"students-orientations",query:r(o({},n.query),{startDate:a.range.start,endDate:a.range.end})});else{const e={startDate:"Please select start date"};a.validation=e}else{const e={endDate:"Please select end date"};a.validation=e}},clearData:()=>{i.push({name:"students-orientations"})}})}J("data-v-3860695f");const ie={class:"page-content-inner"},le={class:"columns search-filter"},se={class:"column"},oe=x("label",null,"Filter Orientation",-1),re={class:"select"},ue=[x("option",{value:void 0},"All Orientations",-1),x("option",{value:"wait_to_orientation"}," Wait to Orientation ",-1),x("option",{value:"wait_to_call"},"Wait to Call",-1),x("option",{value:"done"},"Done",-1)],de={class:"column"},ce=x("label",null,"Filter Student's Country",-1),pe={class:"select"},ve=[x("option",{value:void 0},"All Student",-1),x("option",{value:"th"},"Student TH",-1),x("option",{value:"vn"},"Student VN",-1)],me={key:0,class:"column is-flex filter-date"},ge=x("label",{class:"label-date"},"Date range",-1),fe=["value"],ye=["value"],ke={class:"is-flex is-justify-content-flex-end pt-4"},be=X("Clear Data"),Oe=X("Create"),he={key:1},Ie={key:1},De={key:1},Se={key:1},_e={class:"dark-inverted is-flex is-justify-content-flex-end"},Ce=X("Action"),je=["onClick"],we=[x("div",{class:"icon"},[x("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),x("div",{class:"meta"},[x("span",null,"View"),x("span",null,"View Orientation Detail")],-1)],Ee=["onClick"],Ye=[x("div",{class:"icon"},[x("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),x("div",{class:"meta"},[x("span",null,"Edit"),x("span",null,"Edit Orientation Detail")],-1)];Q();var Ne=Y({setup(e){y.value="Orientation Information",N({title:"Whitehouse: Student"});const{data:t,total:a,isLoading:n,validation:i,orientTableHeaders:l,filterStatus:s,selectFilterStatus:o,filterCountry:r,selectFilterCountry:m,canSelectCountry:g,adminCreateOrientation:D,adminEditOrientation:S,range:_,onFilterDate:C,clearData:j}=ne(),{capabilities:Y,haveActionButton:J}=function(){const e=E((()=>({canView:f(["VIEW_ORIENTATION"]),canCreate:f(["CREATE_ORIENTATION"]),canEdit:f(["EDIT_ORIENTATION"])}))),t=E((()=>e.value.canView&&e.value.canEdit));return{capabilities:e,haveActionButton:t}}(),Q=e=>{switch(e){case d.DONE:return"Done";case d.ORIENTING:return"Orienting";case d.SKIP:return"Skip";case d.DEVICE_READY:return"Device Ready";default:return}},Z=e=>{switch(e){case u.DONE:return"Wait to Orient";case u.NONE:return"Wait to Call";default:return}},ee=e=>{switch(e){case d.DONE:return"success";case d.ORIENTING:return"danger";default:return"white"}},te=V(!1),Ne=V(!1),Ve=V(!1),Pe=V(void 0),Te=V(void 0),Ae=V({datetime:void 0,note:"",userId:null,studentId:null,packageItemId:0,appointStatus:u.NONE,orientedStatus:null}),Re=V(Ae.value),Me=(e,t=!1)=>{var a,n;Te.value=e.id,Pe.value=e,Re.value={datetime:w(null==e?void 0:e.datetime).isValid()?w(null==e?void 0:e.datetime).toDate():void 0,note:(null==e?void 0:e.note)||"",userId:(null==(a=null==e?void 0:e.admin)?void 0:a.id)||null,studentId:(null==(n=null==e?void 0:e.student)?void 0:n.id)||null,packageItemId:null==e?void 0:e.packageItemId,appointStatus:(null==e?void 0:e.appointStatus)||u.NONE,orientedStatus:(null==e?void 0:e.orientedStatus)||null},Ne.value=t,Pe.value&&(te.value=!0)},Fe=()=>{te.value=!0,Ve.value=!0},qe=()=>{te.value=!1,Ne.value=!1,Ve.value=!1,Pe.value=void 0,Re.value={datetime:void 0,note:void 0,userId:null,studentId:null,packageItemId:0,appointStatus:u.NONE,orientedStatus:null}};return(e,u)=>{const d=c,f=p,y=v,w=k,E=P("v-date-picker"),N=b,V=h,ne=P("RouterLink"),Ae=O,xe=I;return T(),A("div",ie,[R(d,{"open-modal":te.value,"is-edit":Ne.value,data:Pe.value,"orient-info":Re.value,"is-create":Ve.value,validation:M(i),onToggleClose:qe,onOnCreate:u[0]||(u[0]=e=>(async e=>{e.packageItemId=e.packageItemId>0?e.packageItemId:null,await D(e)})(e)),onOnChange:u[1]||(u[1]=e=>(async e=>{e.packageItemId=e.packageItemId>0?e.packageItemId:null,await S(Te.value,e)})(e))},null,8,["open-modal","is-edit","data","orient-info","is-create","validation"]),R(xe,{"is-loading":M(n),"search-placeholder":"Search by Orietation ID, Student, Package",headers:M(l),data:M(t),total:M(a),"is-action":M(J)},F({custom:q((()=>[x("div",le,[x("div",se,[R(y,null,{default:q((()=>[oe,R(f,{icon:"feather:briefcase"},{default:q((()=>[x("div",re,[L(x("select",{"onUpdate:modelValue":u[2]||(u[2]=e=>H(s)?s.value=e:null),onChange:u[3]||(u[3]=(...e)=>M(o)&&M(o)(...e))},ue,544),[[W,M(s)]])])])),_:1})])),_:1})]),L(x("div",de,[R(y,null,{default:q((()=>[ce,R(f,{icon:"feather:user"},{default:q((()=>[x("div",pe,[L(x("select",{"onUpdate:modelValue":u[4]||(u[4]=e=>H(r)?r.value=e:null),onChange:u[5]||(u[5]=(...e)=>M(m)&&M(m)(...e))},ve,544),[[W,M(r)]])])])),_:1})])),_:1})],512),[[G,M(g)]]),"wait_to_call"===M(s)||M(n)?$("",!0):(T(),A("div",me,[R(E,{modelValue:M(_),"onUpdate:modelValue":u[6]||(u[6]=e=>H(_)?_.value=e:null),"is-range":"",color:"orange","trim-weeks":"","model-config":{start:{type:"string",mask:"YYYY-MM-DD",timeAdjust:"00:00:00"},end:{type:"string",mask:"YYYY-MM-DD",timeAdjust:"00:00:00"}},masks:{input:"DD/MM/YYYY"},popover:{visibility:"click"}},{default:q((({inputValue:e,inputEvents:t})=>[ge,R(y,{addons:""},{default:q((()=>[R(f,null,{default:q((()=>[x("input",U({value:e.start,class:"input"},B(t.start)),null,16,fe)])),_:2},1024),R(f,null,{default:q((()=>[R(w,{icon:"feather:arrow-right",class:"is-static"})])),_:1}),R(f,null,{default:q((()=>[x("input",U({value:e.end,class:"input"},B(t.end)),null,16,ye)])),_:2},1024),R(f,null,{default:q((()=>[R(w,{color:"warning",icon:"feather:search",outlined:"",onClick:M(C)},null,8,["onClick"])])),_:1})])),_:2},1024)])),_:1},8,["modelValue"])]))])])),appointStatus:q((({value:e})=>[e?(T(),K(V,{key:0,color:"done"===e?"warning":"white",label:Z(e),rounded:"",elevated:""},null,8,["color","label"])):(T(),A("p",he,"-"))])),operator:q((({value:e})=>{var t,a;return[x("p",null,z((null==e?void 0:e.admin)?`(${null==(t=null==e?void 0:e.admin)?void 0:t.id}) ${null==(a=null==e?void 0:e.admin)?void 0:a.fullname}`:"-"),1)]})),package:q((({value:e})=>[e.package?(T(),K(ne,{key:0,to:`/products/packages/${e.package.id}`,target:"_blank",class:"link"},{default:q((()=>[X(z(`(${e.package.id}) ${e.package.packageName}`),1)])),_:2},1032,["to"])):(T(),A("p",Ie,"-"))])),student:q((({value:e})=>[e.student?(T(),K(ne,{key:0,to:`/students/${e.student.id}`,target:"_blank",class:"link"},{default:q((()=>[X(z(`(${e.student.id}) ${e.student.fullnameTh||e.student.fullnameEn} (Tel: ${e.student.phone||"-"})`),1)])),_:2},1032,["to"])):(T(),A("p",De,"-"))])),date:q((({value:e})=>[X(z(e.datetime?M(ae)(e.datetime,"DD/MM/YYYY"):"-"),1)])),time:q((({value:e})=>[X(z(e.datetime?M(ae)(e.datetime,"HH:mm:ss"):"-"),1)])),orientedStatus:q((({value:e})=>[e?(T(),K(V,{key:0,color:ee(e),label:Q(e),rounded:"",elevated:""},null,8,["color","label"])):(T(),A("p",Se,"-"))])),_:2},[M(Y).canCreate?{name:"custom-right",fn:q((()=>[x("div",ke,[R(N,{class:"mr-4",icon:"lnir lnir-reload rem-100",light:"","dark-outlined":"",onClick:M(j)},{default:q((()=>[be])),_:1},8,["onClick"]),R(N,{color:"primary",icon:"fas fa-plus",onClick:Fe},{default:q((()=>[Oe])),_:1})])]))}:void 0,M(J)?{name:"action",fn:q((({value:e})=>[x("div",_e,[R(Ae,{spaced:"",right:""},{button:q((({toggle:e})=>[R(N,{icon:"feather:more-vertical",class:"is-trigger",onClick:e},{default:q((()=>[Ce])),_:2},1032,["onClick"])])),content:q((()=>[M(Y).canView?(T(),A("a",{key:`view-${e.id}`,role:"menuitem",class:"dropdown-item is-media",onClick:t=>Me(e)},we,8,je)):$("",!0),M(Y).canEdit?(T(),A("a",{key:`edit-${e.id}`,role:"menuitem",class:"dropdown-item is-media",onClick:t=>Me(e,!0)},Ye,8,Ee)):$("",!0)])),_:2},1024)])]))}:void 0]),1032,["is-loading","headers","data","total","is-action"])])}}});Ne.__scopeId="data-v-3860695f";export default Ne;
