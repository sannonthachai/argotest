var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,o=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,i=(e,t)=>{for(var a in t||(t={}))n.call(t,a)&&o(e,a,t[a]);if(r)for(var a of r(t))d.call(t,a)&&o(e,a,t[a]);return e};import{A as s,b as c,q as p,a1 as f,k as b,Y as I,ae as u,D as m}from"./vendor.1c8b4573.js";import{o as h}from"./index.d7dc1ff6.js";import{u as x}from"./usePartnerApi.2e3c406b.js";import{u as y}from"./useStudentApi.e8de2a80.js";import"./useNotyf.ddf08f06.js";function l(){const e=s(),r=c(),{getPartnerById:n,getPartnerBatchById:d,editPartnerBatch:o}=x();y();const l=p({partnerId:0,isLoading:!1,info:void 0,batchId:0,batchInfo:{id:0,partnerId:0,index:1,name:"",expectedStart:"",expectedEnd:"",createdAt:"",updatedAt:""},validation:{},startDate:"",endDate:""});f("info",b((()=>l.info))),f("batchInfo",b((()=>l.batchInfo)));const v=b((()=>{var e;return!(null==(e=l.batchInfo)?void 0:e.name)||l.batchInfo.index<1})),D=b((()=>"#edit"===e.hash)),j=async()=>{l.isLoading=!0;const t=await d(parseInt(`${e.params.id}`));if(l.isLoading=!1,!t)return;l.batchId=t.id,l.batchInfo=t,l.partnerId=t.partnerId||0,l.startDate=m(t.expectedStart).format("YYYY-MM-DD"),l.endDate=m(t.expectedEnd).format("YYYY-MM-DD");const a=await n(l.partnerId);l.info=a};return I((()=>{j()})),P=i({},u(l)),t(P,a({isEditMode:D,disabledSave:v,onSave:async()=>{l.isLoading=!0;const t={id:l.batchId,partnerId:l.partnerId,name:l.batchInfo.name,index:l.batchInfo.index,expectedStart:l.startDate,expectedEnd:l.endDate};let a;l.partnerId&&(a=await o(t),h(a,"Partner Batch was updated!")),l.isLoading=!1,r.push({name:"partners-:id",query:i({},e.query),params:{id:e.params.id}})},fetchPartnerInfoById:j,autoFixIndex:()=>{l.batchInfo.index<0&&(l.batchInfo.index=1)}}));var P}export{l as u};
