var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,o=(e,a)=>{for(var t in a||(a={}))l.call(a,t)&&r(e,t,a[t]);if(s)for(var t of s(a))i.call(a,t)&&r(e,t,a[t]);return e},n=(e,s)=>a(e,t(s));import{_ as c}from"./VSwitchBlock.vue_vue&type=script&setup=true&lang.fd20ebd0.js";import{_ as d,a as u}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{o as m,p,j as f,c as v}from"./index.d7dc1ff6.js";import{_ as y}from"./VTag.vue_vue&type=script&setup=true&lang.b31af8ee.js";import{_ as h}from"./DropdownAction.vue_vue&type=script&setup=true&lang.ced09d37.js";import{_ as g}from"./Datatable.aae3ef08.js";import{_ as b}from"./ModalSystemReport.13a18398.js";import{_ as S}from"./VPlaceholderSection.vue_vue&type=script&setup=true&lang.35b0ad2a.js";import{_ as k}from"./VModal.31b4f4ba.js";import{q as C,A as D,b as Y,k as w,Y as _,S as V,ae as j,D as R,d as T,X as M,r as I,E as O,o as B,e as q,x,F as P,h as A,g as E,O as L,ao as H,ap as $,K as U,ai as W,t as F,G as N,y as z,i as G,p as K,a as X}from"./vendor.1c8b4573.js";import{u as J}from"./useClassroomApi.cba9f1f2.js";import{u as Q}from"./usePaginationRoute.780ca235.js";import{t as Z}from"./date.helper.6ae3fc87.js";import{u as ee}from"./useGuardClassReport.038d8a9c.js";import{u as ae}from"./usePrivateClassess.d8ab23c7.js";import{a as te}from"./class-report.enum.31771efb.js";import{c as se}from"./text.helper.174bd8fa.js";import"./VLoader.vue_vue&type=script&setup=true&lang.a96d7daf.js";import"./VFlexPagination.86ce707c.js";import"./search-4-dark.fb3880a5.js";import"./VMessage.vue_vue&type=script&setup=true&lang.1bdbe413.js";import"./SelectOption.vue_vue&type=script&setup=true&lang.934e0be4.js";import"./VCard.vue_vue&type=script&setup=true&lang.27754e87.js";import"./VRadio.89eaf975.js";import"./useNotyf.ddf08f06.js";import"./useOptionApi.f4dc99b9.js";import"./quiz.enum.fc8b95fc.js";import"./index.ec15dc7d.js";import"./lodash.0a1ccad5.js";import"./product.enum.768ca89a.js";function le(){const e=C({systemClassReportList:[],isLoading:!0,total:0,reportType:void 0,isVoiding:!1,currentClassId:null,confirmVoidModal:!1,viewBySpecificTime:!1,dateSearch:!1,filter:{datetime:void 0,search:"",range:{}}}),a=D(),t=Y(),{perPage:s,currentPage:l,search:i}=Q(),{getAllSystemReport:r,voidCancelReport:c,voidSystemReport:d}=J();w((()=>a.query.reportType));const u=async()=>{e.isLoading=!0;const t=a.query.startDate,i=a.query.endDate;a.query.datetime?(e.filter.datetime=new Date(a.query.datetime),e.viewBySpecificTime=!0):t&&i&&(e.filter.range={start:new Date(R(t,"YYYY-MM-DD").startOf("day").toISOString()),end:new Date(R(i,"YYYY-MM-DD").endOf("day").toISOString())});const o={currentPage:l,perPage:s,datetime:e.viewBySpecificTime&&e.dateSearch?R(e.filter.datetime).toISOString():void 0,startDate:!e.viewBySpecificTime&&e.dateSearch?R(e.filter.range.start).toISOString():void 0,endDate:!e.viewBySpecificTime&&e.dateSearch?R(e.filter.range.end).toISOString():void 0,search:e.filter.search},n=await r(o);e.isLoading=!1,n&&(e.systemClassReportList=n.data,e.total=n.total)},p=()=>{t.push({name:"classrooms-class-reports",params:a.params,query:n(o({},a.query),{viewBySpecificTime:e.viewBySpecificTime?"true":"false",dateSearch:e.dateSearch?"true":"false",datetime:e.viewBySpecificTime&&e.dateSearch?R(e.filter.datetime).toISOString():void 0,startDate:!e.viewBySpecificTime&&e.dateSearch?Z(e.filter.range.start,"YYYY-MM-DD"):void 0,endDate:!e.viewBySpecificTime&&e.dateSearch?Z(e.filter.range.end,"YYYY-MM-DD"):void 0,search:e.filter.search})})};_((()=>{(()=>{e.dateSearch="true"===a.query.dateSearch,e.viewBySpecificTime="true"===a.query.viewBySpecificTime;const t=a.query.startDate,s=a.query.endDate;a.query.datetime?(e.filter.datetime=new Date(a.query.datetime),e.viewBySpecificTime=!1):t&&s&&(e.filter.range={start:new Date(R(t,"YYYY-MM-DD").toISOString()),end:new Date(R(s,"YYYY-MM-DD").toISOString())}),e.filter.search=a.query.search})(),u()})),V((()=>e.filter.search),(()=>{""===e.filter.search&&p()}));return n(o({},j(e)),{classReportTableHeaders:[{key:"id",label:"Report Id"},{key:"admin",label:"Report By"},{key:"classroom",label:"Class Id"},{key:"classTime",label:"Class Time",isRaw:!0},{key:"student",label:"Student",isRaw:!0},{key:"coach",label:"Coach",isRaw:!0},{key:"studentSatisfaction",label:"Satisfaction",isCenter:!0},{key:"ticketReturn",label:"Return Ticket",isCenter:!0},{key:"classStatus",label:"Class Status",isCenter:!0},{key:"callStatus",label:"Call Status",isCenter:!0}],fetchAllClassReport:u,onVoidReport:async a=>{e.isVoiding=!0;const t=await d(a);m(t,"Void system-error report success!"),e.isVoiding=!1,e.currentClassId=null,e.confirmVoidModal=!1,await u()},filterChange:p})}K("data-v-7298f919");const ie={class:"page-content-inner"},re={class:"custom-filter"},oe={class:"columns is-multiline"},ne={class:"column is-full is-flex is-align-items-flex-start is-justify-content-flex-start"},ce={key:0,class:"column is-4"},de=A("label",{class:"label-date"},"Datetime ",-1),ue=["disabled","value"],me={key:1,class:"column is-5"},pe=A("label",{class:"label-date"},"Date range",-1),fe=["disabled","value"],ve=["disabled","value"],ye={class:"column is-4 is-flex is-align-items-center is-justify-content-flex-start"},he={class:"column is-8"},ge=A("label",null,"Search",-1),be={key:0},Se={key:1},ke={key:1},Ce={key:1},De={class:"dark-inverted is-flex is-justify-content-flex-end"},Ye=["onClick"],we=[A("div",{class:"icon"},[A("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:file-text"})],-1),A("div",{class:"meta"},[A("span",null,"View Within Class Report"),A("span",null,"view within class report")],-1)],_e=["onClick"],Ve=[A("div",{class:"icon"},[A("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:file-text"})],-1),A("div",{class:"meta"},[A("span",null,"Edit Within Class Report"),A("span",null,"edit within class report")],-1)],je=["onClick"],Re=[A("div",{class:"icon"},[A("i",{"aria-hidden":"true",class:"lnil lnil-trash"})],-1),A("div",{class:"meta"},[A("span",null,"Void Within Class Report"),A("span",null,"remove within class report")],-1)],Te=N("Confirm"),Me=N("Cancel");X();var Ie=T({setup(e){p.value="Within Class Reports",M({title:"Whitehouse: Classroom"});const{systemClassReportList:a,classReportTableHeaders:t,total:s,isLoading:l,reportType:i,onVoidReport:r,isVoiding:o,currentClassId:n,confirmVoidModal:m,fetchAllClassReport:C,filterChange:D,viewBySpecificTime:Y,filter:w,dateSearch:_}=le(),{classIdSystemReport:V,privateSystemReport:j,fetchSystemReportByClassId:R,onSavedReport:T}=ae(),{capabilities:K,haveActionSystemButton:X}=ee(),J=I(!1);I(!1),I(!1);const Q=I(!1),Ie=()=>{n.value=null,m.value=!1},Oe=async(e,a)=>{V.value=e,await R(),Q.value=a,J.value=!0};return(e,i)=>{const p=c,C=d,R=u,M=f,I=O("v-date-picker"),ee=O("RouterLink"),ae=y,le=h,Be=g,qe=b,xe=S,Pe=v,Ae=k;return B(),q("div",ie,[x(Be,{"can-searchable":!1,headers:E(t),data:E(a),total:E(s),"is-loading":E(l),"is-action":E(X)},{"custom-left":P((()=>[A("div",re,[A("div",oe,[A("div",ne,[x(R,null,{default:P((()=>[x(C,null,{default:P((()=>[x(p,{modelValue:E(_),"onUpdate:modelValue":i[0]||(i[0]=e=>L(_)?_.value=e:null),label:"Search Date?",color:"primary",onChange:E(D)},null,8,["modelValue","onChange"])])),_:1})])),_:1})]),E(Y)?(B(),q("div",ce,[x(I,{modelValue:E(w).datetime,"onUpdate:modelValue":i[1]||(i[1]=e=>E(w).datetime=e),"model-config":{type:"string",mask:"YYYY-MM-DD HH:mm"},masks:{inputDateTime24hr:"DD/MM/YYYY HH:mm"},mode:"dateTime",color:"orange","minute-increment":30,popover:{visibility:"click"},is24hr:""},{default:P((({inputValue:e,inputEvents:a})=>[de,x(R,{addons:""},{default:P((()=>[x(C,null,{default:P((()=>[A("input",H({disabled:!E(_),class:"input",value:e},$(a)),null,16,ue)])),_:2},1024),x(C,null,{default:P((()=>[x(M,{disabled:!E(_),color:"warning",icon:"feather:search",outlined:"",onClick:E(D)},null,8,["disabled","onClick"])])),_:1})])),_:2},1024)])),_:1},8,["modelValue"])])):(B(),q("div",me,[x(I,{modelValue:E(w).range,"onUpdate:modelValue":i[2]||(i[2]=e=>E(w).range=e),"is-range":"",color:"orange","trim-weeks":"","model-config":{start:{type:"string",mask:"YYYY-MM-DD",timeAdjust:"00:00:00"},end:{type:"string",mask:"YYYY-MM-DD",timeAdjust:"00:00:00"}},masks:{input:"DD/MM/YYYY"},popover:{visibility:"click"}},{default:P((({inputValue:e,inputEvents:a})=>[pe,x(R,{addons:""},{default:P((()=>[x(C,null,{default:P((()=>[A("input",H({disabled:!E(_),value:e.start,class:"input"},$(a.start)),null,16,fe)])),_:2},1024),x(C,null,{default:P((()=>[x(M,{icon:"feather:arrow-right",class:"is-static"})])),_:1}),x(C,null,{default:P((()=>[A("input",H({disabled:!E(_),value:e.end,class:"input"},$(a.end)),null,16,ve)])),_:2},1024),x(C,null,{default:P((()=>[x(M,{disabled:!E(_),color:"warning",icon:"feather:search",outlined:"",onClick:E(D)},null,8,["disabled","onClick"])])),_:1})])),_:2},1024)])),_:1},8,["modelValue"])])),A("div",ye,[x(R,null,{default:P((()=>[x(C,null,{default:P((()=>[x(p,{modelValue:E(Y),"onUpdate:modelValue":i[3]||(i[3]=e=>L(Y)?Y.value=e:null),class:"pb-1",label:"Switch to "+(E(Y)?"Date range":"Datetime"),color:"primary",disabled:!E(_)},null,8,["modelValue","label","disabled"])])),_:1})])),_:1})]),A("div",he,[x(R,null,{default:P((()=>[ge,x(C,{icon:"feather:search"},{default:P((()=>[U(A("input",{"onUpdate:modelValue":i[4]||(i[4]=e=>E(w).search=e),type:"text",class:"input is-rounded",placeholder:"Search by Report ID, Class ID, Student Name & Phone, Coach Name",onChange:i[5]||(i[5]=(...e)=>E(D)&&E(D)(...e))},null,544),[[W,E(w).search]])])),_:1})])),_:1})])])])])),admin:P((({value:e})=>[(null==e?void 0:e.name)?(B(),q("p",be,F(e.name),1)):(B(),q("p",Se,"-"))])),student:P((({value:e})=>[x(ee,{to:`/students/${e.classroom.student.id}`,target:"_blank",class:"link"},{default:P((()=>[N(F(`(ID: ${e.classroom.student.id}) ${e.classroom.student.fullnameTh||e.classroom.student.fullnameEn} (Tel: ${e.classroom.student.phone||"-"})`),1)])),_:2},1032,["to"])])),classroom:P((({value:e})=>[N(F(e.id),1)])),classTime:P((({value:e})=>{var a;return[N(F((null==(a=e.classroom)?void 0:a.startTime)?E(Z)(e.classroom.startTime,"DD/MM/YYYY HH:mm"):"-"),1)]})),coach:P((({value:e})=>[x(ee,{to:{name:"coaches-info-:id",params:{id:`${e.classroom.coach.id}`}},target:"_blank",class:"link"},{default:P((()=>[N(F(`(ID: ${e.classroom.coach.id}) ${e.classroom.coach.nickname}`),1)])),_:2},1032,["to"])])),studentSatisfaction:P((({value:e})=>[null!=e?(B(),z(ae,{key:0,color:"green"===e?"success":"red"===e?"danger":"light",label:E(se)(e),curved:""},null,8,["color","label"])):(B(),q("div",ke,"-"))])),ticketReturn:P((({value:e})=>[null!=e?(B(),z(ae,{key:0,color:"yes"===e?"success":"no"===e?"danger":"primary",label:E(se)(e),curved:""},null,8,["color","label"])):(B(),q("div",Ce,"-"))])),action:P((({value:e})=>[A("div",De,[x(le,null,{content:P((()=>[E(K).canViewclassreportIssue?(B(),q("a",{key:0,role:"menuitem",class:"dropdown-item is-media",onClick:a=>Oe(e.classroom.id,!0)},we,8,Ye)):G("",!0),E(K).canEditReportClassIssue?(B(),q("a",{key:1,role:"menuitem",class:"dropdown-item is-media",onClick:a=>Oe(e.classroom.id,!1)},Ve,8,_e)):G("",!0),E(K).canVoidSystemReport?(B(),q("a",{key:2,role:"menuitem",class:"dropdown-item is-media",onClick:a=>{return t=e.classroom.id,n.value=t,void(m.value=!0);var t}},Re,8,je)):G("",!0)])),_:2},1024)])])),_:1},8,["headers","data","total","is-loading","is-action"]),x(qe,{modelValue:J.value,"onUpdate:modelValue":[i[6]||(i[6]=e=>J.value=e),i[7]||(i[7]=e=>J.value=e)],"class-id":E(V),"class-report":E(j),readonly:Q.value,onSavedReport:i[8]||(i[8]=e=>E(T)(E(te).SYSTEM_REPORT))},null,8,["modelValue","class-id","class-report","readonly"]),x(Ae,{title:"Confirm Void Report",open:E(m),size:"small",actions:"center",onClose:Ie},{content:P((()=>[x(xe,{subtitle:`You want to void report, Class ID: ${E(n)}`},null,8,["subtitle"])])),action:P((()=>[x(Pe,{color:"primary",raised:"",loading:E(o),onClick:i[9]||(i[9]=e=>E(r)(E(n)))},{default:P((()=>[Te])),_:1},8,["loading"])])),cancel:P((()=>[x(Pe,{raised:"",onClick:Ie},{default:P((()=>[Me])),_:1})])),_:1},8,["open"])])}}});Ie.__scopeId="data-v-7298f919";export default Ie;
