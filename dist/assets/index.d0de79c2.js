var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,d=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;import{e as i,p as u,g as o,c as r}from"./index.d7dc1ff6.js";import{_ as c}from"./VModal.31b4f4ba.js";import{_ as p}from"./VSwitchSegment.vue_vue&type=script&setup=true&lang.43f673db.js";import{_ as m,a as v}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{_ as f}from"./CustomTabs.vue_vue&type=script&setup=true&lang.b78bee55.js";import{_ as y}from"./VCheckbox.0efaaab1.js";import{_ as b}from"./FormTemplate.a6fb27bf.js";import{q as k,b as h,ae as T,d as x,X as g,r as S,k as I,E as _,o as V,y as j,F as E,x as w,g as C,h as O,e as D,H as P,I as U,t as F,O as M,K as L,ai as A,V as q,G as z,ah as K,i as N,p as G,a as H}from"./vendor.1c8b4573.js";import{u as R}from"./useOptionApi.f4dc99b9.js";import{u as W}from"./useStudentApi.e8de2a80.js";import{u as X}from"./useNotyf.ddf08f06.js";import{T as $}from"./ticket.enum.46025ae5.js";import{a as B}from"./student.helper.13430dac.js";import"./quiz.enum.fc8b95fc.js";import"./student.enum.ad6af513.js";function J(){const e=k({extendTicketInfo:{studentIds:void 0,country:void 0,numberDay:1,ticketTypes:[]},inputStudentId:void 0,studentTags:[],isStudentTag:!1,isOpenConfirmExtendTicketPopup:!1,validate:{},selectType:"studentId",isLoading:!1}),u=h(),o=X(),{getStudentsTicketNotExpire:r}=R(),{addExtendExpireTicket:c}=W();return p=((e,t)=>{for(var a in t||(t={}))l.call(t,a)&&d(e,a,t[a]);if(s)for(var a of s(t))n.call(t,a)&&d(e,a,t[a]);return e})({},T(e)),t(p,a({submitExtendTicket:()=>{var t;if(e.extendTicketInfo.country)e.extendTicketInfo.studentIds=void 0;else if(e.extendTicketInfo.country=void 0,e.isStudentTag)e.extendTicketInfo.studentIds=e.studentTags;else{const a=null==(t=e.inputStudentId)?void 0:t.split(",");e.extendTicketInfo.studentIds=null==a?void 0:a.map((e=>parseInt(e)))}e.isOpenConfirmExtendTicketPopup=!0},extendExpireTicket:async()=>{e.isLoading=!0;const t=await c(e.extendTicketInfo);201===t.status?(o.success("success!"),e.validate={},e.isLoading=!1,u.go(0)):"object"==typeof t.message?e.validate=t.message:(o.error(i(t.message)),e.extendTicketInfo.studentIds=void 0,e.isLoading=!1,e.isOpenConfirmExtendTicketPopup=!1)},clearState:t=>{e.extendTicketInfo.country=void 0,e.inputStudentId=void 0,e.studentTags=void 0,e.selectType=t},clearStateSwitch:()=>{e.inputStudentId=void 0,e.studentTags=void 0},studentOptions:async e=>await r(e),showStudentCountry:e=>"th"===e?"Thai Student":"Vietnam Student"}));var p}G("data-v-6a67cdb3");const Q={class:"columns is-multiline mt-5 mb-5"},Y={key:0,class:"column is-4 has-text-centered"},Z=O("h2",{class:"title is-6 is-narrow is-bolder"},"Student",-1),ee={key:1,class:"column is-4 has-text-centered"},te=O("h2",{class:"title is-6 is-narrow is-bolder"},"Country",-1),ae={class:"column is-4 has-text-centered"},se=O("h2",{class:"title is-6 is-narrow is-bolder"},"Extend Ticket",-1),le={class:"column is-4 has-text-centered"},ne=O("h2",{class:"title is-6 is-narrow is-bolder"},"Ticket Type",-1),de=z("Comfirm"),ie=z("Submit"),ue={class:"form-box"},oe={class:"select-student-box"},re={key:0},ce=O("label",null,"Student ID (Use , For more student ) ",-1),pe={class:"help is-warning"},me=O("p",{class:"help has-text-danger"}," * If enter the wrong mark or the ID does not exist, the system may crash. Please enter carefully. ",-1),ve=O("label",null,"Find students whose tickets have not expired. ",-1),fe={class:"multiselect-tag"},ye=["onMousedown"],be={class:"select-option-text"},ke=O("p",{class:"help has-text-danger"},"* Can choose multiple",-1),he={key:1},Te=O("label",null,"Select From Student Type ",-1),xe={class:"form-content"},ge=O("label",null," Extend the ticket expire",-1),Se=O("p",{class:"help has-text-danger"}," * Maximum extend ticket is 30 days. ",-1),Ie=O("label",null,"Ticket Type ",-1);H();var _e=x({setup(e){const{studentTags:t,inputStudentId:a,extendTicketInfo:s,selectType:l,validate:n,submitExtendTicket:d,extendExpireTicket:i,clearState:k,clearStateSwitch:h,studentOptions:T,showStudentCountry:x,isStudentTag:G,isLoading:H,isOpenConfirmExtendTicketPopup:R}=J();u.value="Extend Ticket Student",g({title:"Whitehouse: Student"});const{user:W}=o(),X=S(Object.values($).filter((e=>e!=$.MAKEUP))),_e=S(null==W?void 0:W.manageCountry),Ve=I((()=>{var e;return!!(null==a?void 0:a.value)&&(null==(e=null==a?void 0:a.value)?void 0:e.split(",").every((e=>/^\d+$/.test(e))))})),je=I((()=>(null==a?void 0:a.value)&&Ve.value)),Ee=I((()=>(null==t?void 0:t.value)&&t.value.length>0)),we=I((()=>s.value.country)),Ce=I((()=>s.value.numberDay>=1&&s.value.numberDay<=30&&s.value.ticketTypes.length));return(e,u)=>{const o=r,g=c,S=p,I=m,W=v,$=_("Multiselect"),J=m,Oe=v,De=f,Pe=y,Ue=b;return V(),j(Ue,{title:"Extend Expire Student"},{buttons:E((()=>[w(o,{color:"primary",icon:"feather:check",disabled:!C(je)&&!C(Ee)&&!C(we)||!C(Ce),onClick:C(d)},{default:E((()=>[ie])),_:1},8,["disabled","onClick"])])),default:E((()=>[w(g,{open:C(R),title:"Confirm Extend Expire Student",size:"laugh",actions:"center",onClose:u[0]||(u[0]=e=>R.value=!1)},{content:E((()=>[O("div",Q,[C(s).studentIds?(V(),D("div",Y,[Z,(V(!0),D(P,null,U(C(s).studentIds,(e=>(V(),D("p",{key:e},F(e),1)))),128))])):(V(),D("div",ee,[te,O("p",null,F(C(x)(C(s).country)),1)])),O("div",ae,[se,O("p",null,F(C(s).numberDay)+" Day",1)]),O("div",le,[ne,(V(!0),D(P,null,U(C(s).ticketTypes,(e=>(V(),D("p",{key:e},F(e),1)))),128))])])])),action:E((()=>[w(o,{color:"primary",outlined:"",loading:C(H),disabled:C(H),onClick:C(i)},{default:E((()=>[de])),_:1},8,["loading","disabled","onClick"])])),_:1},8,["open"]),O("div",ue,[O("div",oe,[w(De,{modelValue:C(l),"onUpdate:modelValue":[u[6]||(u[6]=e=>M(l)?l.value=e:null),C(k)],slider:"",class:"tab-box",tabs:[{label:"Student Id",value:"studentId"},{label:"Student Type",value:"studentType"}]},{tab:E((({activeValue:e})=>["studentId"===e?(V(),D("div",re,[w(W,{grouped:""},{default:E((()=>[w(I,null,{default:E((()=>[w(S,{modelValue:C(G),"onUpdate:modelValue":[u[1]||(u[1]=e=>M(G)?G.value=e:null),C(h)],"label-true":"Student Tag","label-false":"Student ID",color:"primary"},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1}),C(G)?(V(),j(Oe,{key:1},{default:E((()=>[ve,w(J,null,{default:E((()=>[w($,{modelValue:C(t),"onUpdate:modelValue":u[4]||(u[4]=e=>M(t)?t.value=e:null),mode:"tags",delay:0,searchable:!0,options:C(T),filterResults:!1,"track-id":"id","tag-by":"id","value-prop":"id",placeholder:"Select Student"},{tag:E((({option:e,remove:t,disabled:a})=>[O("div",fe,[z(F(C(B)(e))+" ",1),a?N("",!0):(V(),D("i",{key:0,onClick:u[3]||(u[3]=K((()=>{}),["prevent"])),onMousedown:K((a=>t(e)),["prevent","stop"])},null,40,ye))])])),option:E((({option:e})=>[O("span",be,F(C(B)(e)),1)])),_:1},8,["modelValue","options"]),ke,L(O("div",{class:"help is-danger"},F(C(n).studentIds),513),[[q,C(n).studentIds]])])),_:1})])),_:1})):(V(),j(W,{key:0},{default:E((()=>[ce,w(I,{icon:"feather:user","is-valid":C(Ve)},{default:E((()=>[L(O("input",{"onUpdate:modelValue":u[2]||(u[2]=e=>M(a)?a.value=e:null),type:"text",class:"input is-primary-focus",placeholder:"7525,4544,2315,1057"},null,512),[[A,C(a)]]),L(O("div",pe," StudentId must be number ",512),[[q,!C(Ve)]]),me,L(O("div",{class:"help is-danger"},F(C(n).studentIds),513),[[q,C(n).studentIds]])])),_:1},8,["is-valid"])])),_:1}))])):"studentType"===e?(V(),D("div",he,[w(Oe,null,{default:E((()=>[Te,w(J,null,{default:E((()=>[w($,{modelValue:C(s).country,"onUpdate:modelValue":u[5]||(u[5]=e=>C(s).country=e),options:_e.value,placeholder:"Selectcountry","can-clear":!0},null,8,["modelValue","options"]),L(O("p",{class:"help is-danger"},F(C(n).country),513),[[q,C(n).country]])])),_:1})])),_:1})])):N("",!0)])),_:1},8,["modelValue","onUpdate:modelValue"])]),O("div",xe,[w(W,null,{default:E((()=>[ge,w(I,{icon:"feather:plus-circle"},{default:E((()=>[L(O("input",{"onUpdate:modelValue":u[7]||(u[7]=e=>C(s).numberDay=e),type:"number",class:"input is-primary-focus",max:"30",min:"1"},null,512),[[A,C(s).numberDay]]),Se,L(O("p",{class:"help is-danger"},F(C(n).numberDay),513),[[q,C(n).numberDay]])])),_:1})])),_:1}),w(W,null,{default:E((()=>[Ie,L(O("p",{class:"help is-danger"},F(C(n).ticketTypes),513),[[q,C(n).ticketTypes]]),w(I,null,{default:E((()=>[(V(!0),D(P,null,U(X.value,(e=>(V(),j(Pe,{key:e,modelValue:C(s).ticketTypes,"onUpdate:modelValue":u[8]||(u[8]=e=>C(s).ticketTypes=e),value:e,label:e,name:"ticket",color:"primary"},null,8,["modelValue","value","label"])))),128))])),_:1})])),_:1})])])])),_:1})}}});_e.__scopeId="data-v-6a67cdb3";export default _e;
