var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,r=(e,a)=>{for(var t in a||(a={}))s.call(a,t)&&i(e,t,a[t]);if(l)for(var t of l(a))n.call(a,t)&&i(e,t,a[t]);return e},o=(e,l)=>a(e,t(l));import{_ as d,a as u}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{c,r as p,s as v,g as m,e as y,l as f,u as g,p as h,j as b,a as w,h as k}from"./index.d7dc1ff6.js";import{_ as I}from"./VModal.31b4f4ba.js";import{p as S,a as _,d as O,k as x,E as C,o as D,y as P,F as j,h as V,x as U,g as M,t as Y,G as q,r as $,e as E,i as N,K as R,ai as L,n as B,H as T,I as A,q as F,D as z,A as W,b as H,Y as G,ae as K,X,av as Q,O as Z,ao as J,ap as ee,aV as ae}from"./vendor.1c8b4573.js";import{_ as te,a as le}from"./InstallmentBankLogo.1c5d38ed.js";import{_ as se}from"./ConfirmModal.c43c7733.js";import{_ as ne}from"./CustomTabs.vue_vue&type=script&setup=true&lang.b78bee55.js";import{_ as ie}from"./V-Snack.vue_vue&type=script&setup=true&lang.68124dfe.js";import{_ as re}from"./VFlex.vue_vue&type=style&index=0&lang.c8620ece.js";import{_ as oe}from"./VCard.vue_vue&type=script&setup=true&lang.27754e87.js";import{_ as de}from"./VTag.vue_vue&type=script&setup=true&lang.b31af8ee.js";import{_ as ue}from"./VAvatarStack.vue_vue&type=script&setup=true&lang.cabf7e43.js";import{_ as ce}from"./VBlock.vue_vue&type=script&setup=true&lang.2e664adb.js";import{_ as pe}from"./Datatable.aae3ef08.js";import{u as ve}from"./usePaginationRoute.780ca235.js";import{u as me,R as ye,S as fe}from"./order.enum.de0a91c5.js";import{u as ge}from"./useNotyf.ddf08f06.js";import{t as he,m as be,y as we}from"./date.helper.6ae3fc87.js";import{u as ke,a as Ie}from"./useGuardSalesmanOrder.0724c123.js";import{b as Se}from"./student.helper.13430dac.js";import{u as _e,c as Oe,b as xe,e as Ce,f as De,g as Pe,t as je,h as Ve}from"./useTextHelper.08cd3a6d.js";import{a as Ue}from"./common.helper.74291d4c.js";import"./SelectOption.vue_vue&type=script&setup=true&lang.934e0be4.js";import"./VPlaceholderSection.vue_vue&type=script&setup=true&lang.35b0ad2a.js";import"./VLoader.vue_vue&type=script&setup=true&lang.a96d7daf.js";import"./VFlexPagination.86ce707c.js";import"./search-4-dark.fb3880a5.js";import"./index.ec15dc7d.js";import"./lodash.0a1ccad5.js";import"./student.enum.ad6af513.js";import"./csv.helper.d14e8c45.js";import"./index.8f8d8101.js";S("data-v-83ced46a");const Me={class:"select-layout"},Ye=V("label",null,"Owner",-1),qe={class:"multiselect-single-label"},$e={class:"select-option-text"},Ee=q(" Update ");_();var Ne=O({props:{open:{type:Boolean,default:!1},title:{type:String,default:"Update"},ownerOptions:{type:Array,default:()=>[]},ownerId:{type:Number,default:void 0},owner:{type:Object,default:void 0}},emits:["close","on-update"],setup(e,{emit:a}){const t=e,l=x((()=>!!t.ownerId)),s=x((()=>!t.ownerOptions.find((e=>{var a;return e.id===(null==(a=t.owner)?void 0:a.id)}))&&t.owner?t.ownerOptions.concat(t.owner):t.ownerOptions));return(n,i)=>{const r=C("Multiselect"),o=d,p=u,v=c,m=I;return D(),P(m,{open:e.open,title:`${e.title} owner`,actions:"right",onClose:i[2]||(i[2]=e=>a("close"))},{content:j((()=>[V("div",Me,[U(p,null,{default:j((()=>[Ye,U(o,null,{default:j((()=>[U(r,{modelValue:t.ownerId,"onUpdate:modelValue":i[0]||(i[0]=e=>t.ownerId=e),options:M(s),searchable:!0,"track-by":"name",label:"name","value-prop":"id",placeholder:"select owner",class:"filter-option"},{singlelabel:j((({value:e})=>[V("div",qe," ("+Y(e.id)+") "+Y(e.name),1)])),option:j((({option:e})=>[V("span",$e," ("+Y(e.id)+") "+Y(e.name),1)])),_:1},8,["modelValue","options"])])),_:1})])),_:1})])])),action:j((()=>[U(v,{color:"primary",disabled:!M(l),onClick:i[1]||(i[1]=t=>a("on-update",e.ownerId))},{default:j((()=>[Ee])),_:1},8,["disabled"])])),_:1},8,["open","title"])}}});Ne.__scopeId="data-v-83ced46a";const Re={v:"",class:"select-layout p-4"},Le={key:0},Be=V("label",null,"Opportunity Id",-1),Te=q(" Update ");var Ae=O({props:{open:{type:Boolean,default:!1},title:{type:String,default:"Update"},opportunityId:{type:String,default:void 0},orderId:{type:Number,default:void 0},waitingUpdate:{type:Boolean,default:!1}},emits:["close","on-update"],setup(e,{emit:a}){const t=e,l=$(!1),s=x((()=>!(!t.opportunityId||t.waitingUpdate))),n=x((()=>`\n  <p>Order Id ${t.orderId}</p>\n  <p>Opportunity Id <strong>${t.opportunityId}</strong></p>\n  `)),i=()=>{l.value=!1,a("on-update",t.opportunityId)};return(r,o)=>{const v=se,m=d,y=u,f=p,g=c,h=I;return D(),E("div",null,[t.opportunityId?(D(),P(v,{key:0,"is-html":!0,"modal-title":"Confirm",title:M(n),open:!!l.value,onClose:o[0]||(o[0]=e=>l.value=!1),onConfirm:i},null,8,["title","open"])):N("",!0),U(h,{open:e.open,title:`${e.title} Salesforce`,actions:"right",onClose:o[3]||(o[3]=e=>a("close"))},{content:j((()=>[V("div",Re,[t.waitingUpdate?(D(),P(f,{key:1,height:"30px",width:"100%"})):(D(),E("div",Le,[U(y,null,{default:j((()=>[Be,U(m,null,{default:j((()=>[R(V("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>t.opportunityId=e),type:"text",class:"input is-primary-focus"},null,512),[[L,t.opportunityId]])])),_:1})])),_:1})]))])])),action:j((()=>[U(g,{color:"primary",disabled:!M(s),onClick:o[2]||(o[2]=e=>l.value=!0)},{default:j((()=>[Te])),_:1},8,["disabled"])])),_:1},8,["open","title"])])}}}),Fe=O({props:{size:{type:String,required:!1,default:void 0},rounded:{type:String,required:!1,default:"full"},centered:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1}},setup(e){const a=e;return(e,t)=>(D(),E("div",{class:B(["placeload-avatar",[!a.disabled&&"loads",a.size&&`is-${a.size}`,a.centered&&"is-centered",a.rounded&&`is-rounded-${a.rounded}`]])},null,2))}});const ze={class:"content-shape-group"};var We=O({props:{width:{type:String,required:!1,default:"100%"},lastLineWidth:{type:String,required:!1,default:"100%"},lines:{type:Number,required:!1,default:2},disabled:{type:Boolean,required:!1},centered:{type:Boolean,required:!1}},setup(e){const a=e;return null===a.width.match(v)&&console.warn(`VPlaceloadText: invalid "${a.width}" width. Should be a valid css unit value.`),null===a.lastLineWidth.match(v)&&console.warn(`VPlaceloadText: invalid "${a.lastLineWidth}" lastLineWidth. Should be a valid css unit value.`),(e,t)=>{const l=p;return D(),E("div",ze,[(D(!0),E(T,null,A(a.lines-1,(e=>(D(),P(l,{key:e,width:a.width,centered:a.centered},null,8,["width","centered"])))),128)),U(l,{width:a.lastLineWidth,centered:a.centered},null,8,["width","centered"])])}}});const He=["value","max"];var Ge=O({props:{value:{type:Number,required:!1,default:void 0},max:{type:Number,required:!1,default:100},size:{type:String,required:!1,default:void 0},color:{type:String,required:!1,default:"primary"}},setup(e){const a=e;return(e,t)=>(D(),E("progress",{class:B(["progress",[a.size&&`is-${a.size}`,a.color&&`is-${a.color}`]]),value:a.value,max:a.max},Y(a.value?a.value/a.max*100+"%":""),11,He))}});function Ke(){const e=$([]),a=F({data:[],total:0,isLoading:!0,filter:{year:z().year(),month:z().month()+1,ownerId:void 0,range:{}},selectType:"year",revenues:[],chartData:{},isLoadingRevenue:!1,isOpenSalesmanModal:!1,isOpenSalesforceModal:!1,waitingUpdate:!1}),t=W(),l=H(),{user:s}=m(),n=x((()=>a.revenues.find((e=>"All"===e.type)))),i=ge(),{search:d,currentPage:u,perPage:c}=ve(),{getOrderWithSalesman:p,getAllSalesmanOwnerName:v,updateSalesmanOwner:g,updateSalesforce:h,getOrderRevenues:b}=me(),{editAddress:w}=ke(),k=x((()=>"year"===a.selectType?{year:a.filter.year,month:a.filter.month}:{startDate:z(a.filter.range.start).toISOString(),endDate:z(a.filter.range.end).toISOString()})),I=async()=>{a.isLoading=!0;const e=await p(r({search:d,currentPage:u,perPage:c,ownerId:a.filter.ownerId},k.value));a.data=(null==e?void 0:e.data)||[],a.total=(null==e?void 0:e.total)||0,a.isLoading=!1},S=()=>{l.push(o(r({},t),{query:o(r({},t.query),{month:a.filter.month,year:a.filter.year,ownerId:a.filter.ownerId,viewBy:a.selectType,startDate:void 0,endDate:void 0,page:1})}))},_=()=>{l.push(o(r({},t),{query:o(r({},t.query),{month:void 0,year:void 0,viewBy:a.selectType,ownerId:a.filter.ownerId,startDate:he(a.filter.range.start,"YYYY-MM-DD"),endDate:he(a.filter.range.end,"YYYY-MM-DD"),page:1})}))};G((async()=>{const l=await v();if(l.length>0&&(e.value=l),t.query.ownerId){const e=parseInt(t.query.ownerId);a.filter.ownerId=isNaN(e)?void 0:e}else!t.query.hasOwnProperty("ownerId")&&l.some((e=>e.id===(null==s?void 0:s.id)))?a.filter.ownerId=null==s?void 0:s.id:t.query.hasOwnProperty("ownerId")&&(a.filter.ownerId=0);if(t.query.month){const e=parseInt(t.query.month);a.filter.month=isNaN(e)?z().month()+1:e}if(t.query.year){const e=parseInt(t.query.year);a.filter.year=isNaN(e)?z().year():e}const i=t.query.startDate,d=t.query.endDate;if("date"===t.query.viewBy||"year"===t.query.viewBy)if(a.selectType=t.query.viewBy,i&&d)a.filter.range={start:new Date(z(i,"YYYY-MM-DD").startOf("day").toISOString()),end:new Date(z(d,"YYYY-MM-DD").endOf("day").toISOString())};else{const e=z().startOf("day"),t=z(e).endOf("day");a.filter.range={start:new Date(e.toISOString()),end:new Date(t.toISOString())}}I(),a.isLoadingRevenue=!0;const u=await Promise.all(Object.values(ye).map((e=>b(o(r({},k.value),{productType:"all"===e?void 0:e})))));a.revenues=u.map(((t,l)=>((t,l)=>{const s={all:"All",pro:"Pro",kid:"Kids",speakinglab:"Speaking Lab",chinese:"Chinese",qkids:"Q Kids"},n=null==t?void 0:t.reduce(((a,t,l)=>{var s,n,i,d;(null==(s=null==t?void 0:t.admin)?void 0:s.id)&&!e.value.find((e=>e.id===t.admin.id))&&e.value.push(t.admin);const u={id:(null==(n=null==t?void 0:t.admin)?void 0:n.id)||1e4*(l+1),name:(null==(i=null==t?void 0:t.admin)?void 0:i.name)||"Anonymus",avatar:(null==(d=null==t?void 0:t.admin)?void 0:d.avatar)||"",revenue:t.revenue+t.refundPrice,conversions:t.conversion+t.refundConversion,progress:0!==l?Math.round(100*t.revenue/a.users[0].revenue):100};return o(r({},a),{refundConversions:a.refundConversions+=t.refundConversion,refundPrices:a.refundPrices+=t.refundPrice,conversions:a.conversions+=t.conversion,revenues:a.revenues+=t.revenue,users:u.revenue>0?[...a.users,u]:a.users})}),{refundConversions:0,refundPrices:0,conversions:0,revenues:0,users:[],isExpland:!1,type:s[l]});if(n.users=n.users.map((e=>o(r({},e),{percentage:Math.round(100*e.revenue/n.revenues)}))),parseInt(`${a.filter.ownerId}`)){const e=t.find((e=>{var t;return(null==(t=null==e?void 0:e.admin)?void 0:t.id)==parseInt(`${a.filter.ownerId}`)}));return e?{refundConversions:e.refundConversion,refundPrices:e.refundPrice,conversions:e.conversion,revenues:e.revenue,users:n.users.filter((a=>a.id==e.admin.id)),isExpland:!1,type:s[l]}:{revenues:0}}return n})(t,Object.values(ye)[l]))).filter((({revenues:e})=>e>0)),(()=>{const e=a.revenues.filter((e=>"All"!==e.type));a.chartData={series:[{name:"Users",type:"column",data:e.map((e=>(null==e?void 0:e.conversions)+(null==e?void 0:e.refundConversions)))},{name:"Revenue",type:"area",data:e.map((e=>(null==e?void 0:e.revenues)+(null==e?void 0:e.refundPrices)))}],chartOptions:{chart:{height:300,type:"column",stacked:!1,toolbar:!1},stroke:{width:[0,2,5],curve:"smooth"},plotOptions:{bar:{columnWidth:"50%"}},fill:{opacity:[.85,.25,1],gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.85,opacityTo:.55,stops:[0,100,100,100]}},title:{text:`${(n.value.revenues+n.value.refundPrices).toLocaleString("en-US",{minimumFractionDigits:2})} THB - ${n.value.conversions+n.value.refundConversions} Users (${z().set("y",parseInt(`${a.filter.year}`)).set("M",parseInt(`${a.filter.month}`)-1).format("YYYY MMM")})`,align:"left",offsetX:110},xaxis:{categories:e.map((e=>null==e?void 0:e.type))},yaxis:[{seriesName:"Conversions",opposite:!0,axisTicks:{show:!0},axisBorder:{show:!0,color:"#008FFB"},labels:{style:{colors:"#008FFB"},formatter:e=>e.toLocaleString("en-US",{minimumFractionDigits:0})},title:{text:"Users",style:{color:"#008FFB"}},tooltip:{enabled:!0}},{seriesName:"Revenue",axisTicks:{show:!0},axisBorder:{show:!0,color:"#00E396"},labels:{style:{colors:"#00E396"},formatter:e=>e.toLocaleString("en-US",{minimumFractionDigits:2})},title:{text:"Revenue",style:{color:"#00E396"}}}],tooltip:{shared:!0,intersect:!1,y:{formatter:function(e){return f(e)}}}}}})(),a.isLoadingRevenue=!1}));return o(r({},K(a)),{summary:n,fetchOrders:I,filterChange:S,ownerOptions:e,updateSalesman:async e=>{const t=await g(e);200===t.status?(a.isOpenSalesmanModal=!1,i.success("success!"),I()):i.error(y(t.message))},updateSalesforce:async e=>{a.waitingUpdate=!0;const t=await h(e);200===t.status?(a.isOpenSalesforceModal=!1,a.waitingUpdate=!1,i.success("success!"),I()):(i.error(y(t.message)),a.waitingUpdate=!1)},filterChangeDate:_,clearState:e=>{"date"===e?_():S()},edit:async(e,a)=>{const{status:t,message:l}=await w(a,e);return 200===t?(i.success("Edit order address completed!"),await I()):i.error(y(l)),200===t}})}S("data-v-bb41e9c6");const Xe={class:"columns is-multiline"},Qe={class:"column is-5-desktop is-6-widescreen is-12"},Ze={key:0,class:"columns is-multiline"},Je={class:"column is-6"},ea=V("label",{class:"label-date"},"Date range",-1),aa=["value"],ta=["value"],la={key:1,class:"columns is-multiline"},sa={class:"column is-6"},na=V("label",null,"Year",-1),ia={class:"column is-6"},ra=V("label",null,"Month",-1),oa={class:"columns is-multiline"},da={class:"column is-6 pr-0"},ua={class:"multiselect-single-label"},ca={class:"select-option-text"},pa={key:0,class:"column is-5 py-2 pr-0"},va=V("i",{class:"iconify","data-icon":"feather:x"},null,-1),ma={class:"column is-12"},ya={key:2},fa={key:0,class:"total-refund"},ga={class:"column is-7-desktop is-6-widescreen is-12"},ha={class:"columns is-multiline is-align-items-center"},ba={class:"card-head"},wa={class:"column is-8"},ka={class:"card-inner"},Ia={class:"card-head"},Sa={class:"column is-8"},_a={class:"title is-5 is-narrow"},Oa=["onClick"],xa=q(" Collapse "),Ca={class:"card-inner"},Da={key:1,class:"has-text-centered"},Pa={style:{"list-style-type":"circle"}},ja=["onClick"],Va={style:{"list-style-type":"circle"}},Ua={key:0,class:"transaction-row"},Ma={key:0,class:"transaction-row"},Ya={key:0,class:"is-flex is-align-items-center"},qa={class:"ml-2 nowrap"},$a={key:1,class:"is-flex is-align-items-center"},Ea=["src"],Na={class:"ml-1 capitalize"},Ra={key:2,class:"has-text-centered"},La=["onClick"],Ba={key:1},Ta=q("Actions"),Aa=["onClick"],Fa=[V("div",{class:"icon"},[V("i",{"aria-hidden":"true",class:"lnir lnir-eye"})],-1),V("div",{class:"meta"},[V("span",null,"View Address"),V("span",null,"view student address")],-1)],za=["onClick"],Wa=V("div",{class:"icon"},[V("i",{class:"lnil lnil-user-alt","aria-hidden":"true"})],-1),Ha={class:"meta"},Ga=["onClick"],Ka=V("div",{class:"icon"},[V("i",{class:"lnil lnil-user-alt","aria-hidden":"true"})],-1),Xa={class:"meta"};_();var Qa=O({setup(e){h.value="Salesman Performance",X({title:"Whitehouse: Salesman Performance"});const a=$({userId:void 0,orderId:void 0}),t=$({orderId:void 0,opportunityId:void 0}),l=$(void 0),s=$({no:"",subDistrict:"",district:"",province:"",zipcode:""}),{data:n,filter:i,revenues:v,chartData:m,summary:y,selectType:I,total:S,isLoading:_,filterChange:O,ownerOptions:L,isLoadingRevenue:F,updateSalesman:z,isOpenSalesmanModal:W,updateSalesforce:H,isOpenSalesforceModal:G,waitingUpdate:K,filterChangeDate:se,clearState:ve,edit:me}=Ke(),{capabilities:ye,haveActionButton:ge}=function(){const e=x((()=>({canEditSalesman:g(["EDIT_SALESMAN_OWNER"]),canEditSalesforce:g(["EDIT_SALESMAN_OPPORTUNITY_ID"])}))),a=x((()=>e.value.canEditSalesman||e.value.canEditSalesforce));return{capabilities:e,haveActionButton:a}}(),{displayPackageName:ke}=_e(),{capabilities:Me}=Ie(),Ye=$(be),qe=$(we(5,0)),$e=$([{key:"id",label:"Order Id"},{key:"receiptNumber",label:"Receipt Number",isRaw:!0},{key:"student",label:"Student",isRaw:!0},{key:"paidDate",label:"Paid date"},{key:"phone",label:"Phone",isRaw:!0},{key:"packages",label:"Package",isRaw:!0},{key:"price",label:"Price"},{key:"paidPrice",label:"Paid Price"},{key:"method",label:"Method",isRaw:!0,isCenter:!0},{key:"gateway",label:"Gateway",isRaw:!0,isCenter:!0},{key:"transactions",label:"Pay via",isRaw:!0},{key:"salesman",label:"Owner"},{key:"salesforce",label:"Salesforce",isRaw:!0,isCenter:!0},{key:"status",label:"Status",isCenter:!0}]),Ee=$([{key:"id",label:"Order Id"},{key:"receiptNumber",label:"Receipt Number"},{key:"student",label:"Student"},{key:"paidDate",label:"Paid date"},{key:"phone",label:"Phone"},{key:"packages",label:"Package"},{key:"price",label:"Price"},{key:"paidPrice",label:"Paid Price"},{key:"method",label:"Method"},{key:"salesman",label:"Owner"},{key:"opportunityId",label:"Salesforce"},{key:"status",label:"Status"}]),Re=x((()=>Oe(Ee.value,n.value))),Le=x((()=>F.value?3:0)),Be=e=>e===fe.REFUND,Te=e=>{const a=e.split(".");return`${f(parseInt(a[0]))}.${a[1]}`},ze=$(!1),He=$(void 0),Qa=$(!1),Za=()=>{i.value.ownerId=0,O()},Ja=e=>{a.value=o(r({},a),{orderId:a.value.orderId,userId:e}),l.value=void 0,z(a.value)},et=()=>{W.value=!1,a.value=o(r({},a),{orderId:void 0,userId:void 0})},at=e=>{t.value.orderId=e.id,t.value.opportunityId=(null==e?void 0:e.opportunityId)||void 0,G.value=!0},tt=e=>{t.value=o(r({},t),{orderId:t.value.orderId,opportunityId:e}),H(t.value)},lt=()=>{G.value=!1,t.value=o(r({},t),{orderId:void 0,opportunityId:void 0})};return(e,f)=>{var g,h;const x=Ne,$=te,z=Ae,H=d,X=b,fe=u,ge=C("v-date-picker"),be=C("Multiselect"),we=d,Ie=u,_e=ne,Oe=ie,Ee=p,Ke=re,st=C("apexchart"),nt=oe,it=Fe,rt=We,ot=de,dt=ue,ut=c,ct=w,pt=ce,vt=Ge,mt=C("RouterLink"),yt=le,ft=b,gt=c,ht=k,bt=pe,wt=Q("tooltip");return D(),E("div",null,[U(x,{open:!!M(W),"owner-options":M(L),title:a.value.userId?"Update":"Creat","owner-id":a.value.userId,owner:l.value,onOnUpdate:Ja,onClose:et},null,8,["open","owner-options","title","owner-id","owner"]),U($,{modelValue:ze.value,"onUpdate:modelValue":f[0]||(f[0]=e=>ze.value=e),"order-id":(null==(g=He.value)?void 0:g.id)||0,address:s.value,"is-edit":Qa.value,"can-edit":M(Me).canEditOrderAddress,onOnEdit:f[1]||(f[1]=e=>Qa.value=!0),onSave:f[2]||(f[2]=e=>{var a;return M(me)(e,(null==(a=He.value)?void 0:a.id)||0)})},null,8,["modelValue","order-id","address","is-edit","can-edit"]),U(z,{open:!!M(G),title:t.value.opportunityId?"Update":"Creat","opportunity-id":t.value.opportunityId,"order-id":t.value.orderId,"waiting-update":M(K),onOnUpdate:tt,onClose:lt},null,8,["open","title","opportunity-id","order-id","waiting-update"]),V("div",Xe,[V("div",Qe,[U(nt,{elevated:""},{default:j((()=>{var e,a,t,l,s;return[U(_e,{modelValue:M(I),"onUpdate:modelValue":[f[6]||(f[6]=e=>Z(I)?I.value=e:null),M(ve)],slider:"",class:"mb-1",tabs:[{label:"Select date",value:"date"},{label:"Select year",value:"year"}]},{tab:j((({activeValue:e})=>["date"===e?(D(),E("div",Ze,[V("div",Je,[U(ge,{modelValue:M(i).range,"onUpdate:modelValue":f[3]||(f[3]=e=>M(i).range=e),"is-range":"",color:"orange","trim-weeks":"","model-config":{start:{type:"string",mask:"YYYY-MM-DD",timeAdjust:"00:00:00"},end:{type:"string",mask:"YYYY-MM-DD",timeAdjust:"00:00:00"}},masks:{input:"DD/MM/YYYY"},popover:{visibility:"click"}},{default:j((({inputValue:e,inputEvents:a})=>[ea,U(fe,{addons:""},{default:j((()=>[U(H,null,{default:j((()=>[V("input",J({value:e.start,class:"input"},ee(a.start)),null,16,aa)])),_:2},1024),U(H,null,{default:j((()=>[U(X,{icon:"feather:arrow-right",class:"is-static"})])),_:1}),U(H,null,{default:j((()=>[V("input",J({value:e.end,class:"input"},ee(a.end)),null,16,ta)])),_:2},1024),U(H,null,{default:j((()=>[U(X,{color:"warning",icon:"feather:search",outlined:"",onClick:M(se)},null,8,["onClick"])])),_:1})])),_:2},1024)])),_:1},8,["modelValue"])])])):"year"===e?(D(),E("div",la,[V("div",sa,[U(Ie,null,{default:j((()=>[na,U(we,null,{default:j((()=>[U(be,{modelValue:M(i).year,"onUpdate:modelValue":f[4]||(f[4]=e=>M(i).year=e),options:qe.value,"value-prop":"value",placeholder:"filter by year","can-clear":!1,class:"filter-option",onSelect:M(O)},null,8,["modelValue","options","onSelect"])])),_:1})])),_:1})]),V("div",ia,[U(Ie,null,{default:j((()=>[ra,U(we,null,{default:j((()=>[U(be,{modelValue:M(i).month,"onUpdate:modelValue":f[5]||(f[5]=e=>M(i).month=e),options:Ye.value,"value-prop":"value",placeholder:"filter by month","can-clear":!1,class:"filter-option",onSelect:M(O)},null,8,["modelValue","options","onSelect"])])),_:1})])),_:1})])])):N("",!0)])),_:1},8,["modelValue","onUpdate:modelValue"]),V("div",oa,[V("div",da,[U(Ie,null,{default:j((()=>[U(we,null,{default:j((()=>[U(be,{key:M(i).ownerId,modelValue:M(i).ownerId,"onUpdate:modelValue":[f[7]||(f[7]=e=>M(i).ownerId=e),M(O)],options:M(L),searchable:!0,"track-by":"name",label:"name","value-prop":"id",placeholder:"filter by owner",class:"filter-option"},{singlelabel:j((({value:e})=>[V("div",ua," ("+Y(e.id)+") "+Y(e.name),1)])),option:j((({option:e})=>[V("span",ca," ("+Y(e.id)+") "+Y(e.name),1)])),_:1},8,["modelValue","options","onUpdate:modelValue"])])),_:1})])),_:1})]),M(i).ownerId?(D(),E("div",pa,[U(Oe,{style:{cursor:"pointer"},title:`${(null==(e=M(L).find((({id:e})=>e===M(i).ownerId)))?void 0:e.name)||`${M(i).ownerId}`}`,white:"",icon:"fas fa-user",onClick:Za},{default:j((()=>[va])),_:1},8,["title"])])):N("",!0),V("div",ma,[M(F)?(D(),P(Ke,{key:0,"justify-content":"center"},{default:j((()=>[U(Ee,{height:"300px",width:"80%",class:"mx-2"})])),_:1})):(null==(s=null==(l=null==(t=null==(a=M(m))?void 0:a.chartOptions)?void 0:t.xaxis)?void 0:l.categories)?void 0:s.length)>0?(D(),P(st,{key:1,type:"line",height:"350",options:M(m).chartOptions,series:M(m).series},null,8,["options","series"])):(D(),E("p",ya,"No data"))])])]})),_:1}),(null==(h=M(y))?void 0:h.refundPrices)?(D(),E("p",fa," Refund Total: "+Y(M(y).refundPrices.toLocaleString("en-US",{minimumFractionDigits:2}))+" THB ",1)):N("",!0)]),V("div",ga,[V("div",ha,[(D(!0),E(T,null,A(M(Le),(e=>(D(),E("div",{key:e,class:B(0===M(v).length&&"column is-6")},[U(nt,{elevated:""},{default:j((()=>[V("div",ba,[V("div",wa,[U(Ee,{height:"25px",width:"40%"}),U(Ke,{"align-items":"center",class:"pt-2"},{default:j((()=>[U(Ee,{height:"20px",width:"30%",class:"mr-2"}),U(Ee,{height:"20px",width:"30%",class:"mr-2"})])),_:1})]),U(it,{size:"small"})]),V("div",ka,[U(rt,{lines:3,width:"95%","last-line-width":"45%",class:"mx-3"})])])),_:1})],2)))),128)),(D(!0),E(T,null,A(M(v),((e,a)=>(D(),E("div",{key:e.type,style:{transition:"width 0.3s ease-out"},class:B((null==e?void 0:e.isExpland)?"column is-12 order-first":"column is-6")},[U(nt,{elevated:""},{default:j((()=>{var t;return[V("div",Ia,[V("div",Sa,[V("h2",_a,Y(e.type),1),U(Ke,{"align-items":"center"},{default:j((()=>[U(ot,{class:"mt-2 mr-2",color:"primary",label:`${e.conversions+e.refundConversions} Users`,rounded:"",outlined:""},null,8,["label"]),U(ot,{class:"mt-2 mr-2",color:"primary",label:`${(e.revenues+e.refundPrices).toLocaleString("en-US",{minimumFractionDigits:2})} THB`,rounded:"",outlined:""},null,8,["label"])])),_:2},1024)]),V("div",{style:{cursor:"pointer"},onClick:e=>{return t=a,void(v.value=v.value.map(((e,a)=>o(r({},e),{isExpland:t===a&&!e.isExpland}))));var t}},[(null==e?void 0:e.isExpland)?(D(),P(ut,{key:1,style:{transform:"scale(0.75)"},color:"info",icon:"feather:chevrons-left",rounded:"",light:"",small:""},{default:j((()=>[xa])),_:1})):(D(),P(dt,{key:0,avatars:null==(t=null==e?void 0:e.users)?void 0:t.map((e=>null==e?void 0:e.avatar)),size:"small",limit:3},null,8,["avatars"]))],8,Oa)]),V("div",Ca,[U(Ke,{"flex-direction":"column"},{default:j((()=>[(D(!0),E(T,null,A(null==e?void 0:e.users,((a,t)=>(D(),P(Ke,{key:a.id,"justify-content":"space-between","align-items":"center"},{default:j((()=>[t<3||e.isExpland?(D(),P(pt,{key:0,title:a.name,subtitle:`${a.conversions} users`,center:"",class:"no-margin"},{icon:j((()=>[U(ct,{initials:a.percentage+"%",color:"info",size:"small",squared:""},null,8,["initials"])])),_:2},1032,["title","subtitle"])):N("",!0),t<3||e.isExpland?(D(),P(Ke,{key:1,"flex-direction":"column","align-items":"flex-end"},{default:j((()=>{var t;return[V("p",null,Y(null==(t=a.revenue)?void 0:t.toLocaleString("en-US",{minimumFractionDigits:2})),1),U(vt,{style:ae((null==e?void 0:e.isExpland)?"transform: rotate(180deg); width: 240px":"transform: rotate(180deg); width: 120px"),value:a.progress,size:"tiny"},null,8,["style","value"])]})),_:2},1024)):N("",!0)])),_:2},1024)))),128))])),_:2},1024)])]})),_:2},1024)],2)))),128))])])]),U(bt,{headers:$e.value,data:M(n),total:M(S),"is-loading":M(_),"search-placeholder":"search by order id, student name","is-action":"",class:"salesman-table","can-export":!0,"csv-custom-data":M(Re),"file-name":"sale performance"},{student:j((({value:e})=>[e.student?(D(),P(mt,{key:0,to:{name:"students-:id",params:{id:e.student.id}},target:"_blank",class:"link"},{default:j((()=>[q(Y(M(Se)(e.student)),1)])),_:2},1032,["to"])):(D(),E("p",Da,"-"))])),receiptNumber:j((({value:e})=>[V("ul",Pa,[(D(!0),E(T,null,A(e.receiptNumber,((e,a)=>(D(),E("li",{key:a},[R(V("p",{class:"receipt-number",onClick:a=>M(Ue)(e)},[q(Y(e),1)],8,ja),[[wt,"Copy receipt number"]])])))),128))])])),phone:j((({value:e})=>{var a;return[q(Y((null==(a=null==e?void 0:e.student)?void 0:a.phone)||"-"),1)]})),paidDate:j((({value:e})=>[q(Y(M(he)(e)),1)])),price:j((({value:e})=>[q(Y(Te(e)),1)])),paidPrice:j((({value:e})=>[q(Y(Te(e)),1)])),packages:j((({value:e})=>[V("ul",Va,[(D(!0),E(T,null,A(e.packages,(a=>(D(),E("li",{key:`${e.id}-${a.id}`,class:"mb-1"},[U(mt,{to:{name:"products-packages-:id",params:{id:a.id}},target:"_blank",class:"link"},{default:j((()=>[q(Y(M(ke)(a)),1)])),_:2},1032,["to"])])))),128))])])),method:j((({value:e})=>[e.transactions&&e.transactions.length?(D(),E("div",Ua,[(D(!0),E(T,null,A(e.transactions,((a,t)=>(D(),P(ot,{key:`method-${e.id}-${t}`,label:M(xe)(a.method),color:M(Ce)(a.method)},null,8,["label","color"])))),128))])):N("",!0)])),gateway:j((({value:e})=>[e.transactions&&e.transactions.length?(D(),E("div",Ma,[(D(!0),E(T,null,A(e.transactions,((a,t)=>(D(),P(ot,{key:`method-${e.id}-${t}`,label:M(De)(a.gateway),color:M(Pe)(a.gateway),outlined:""},null,8,["label","color"])))),128))])):N("",!0)])),transactions:j((({value:e})=>[e.transactions&&e.transactions.length?(D(!0),E(T,{key:0},A(e.transactions,((a,t)=>(D(),E("div",{key:`transaction-${e.id}-${t}`,class:"transaction-row"},["installment-payment"===a.method?(D(),E("div",Ya,[U(yt,{"bank-name":a.bank},null,8,["bank-name"]),V("p",qa,Y(`(${a.installmentTerm} month)`),1)])):"transfer-payment"===a.method?(D(),E("div",$a,[V("img",{src:M(je)(a.bank),class:"bank-logo"},null,8,Ea),V("p",Na,Y(M(Ve)(a.bank)),1)])):(D(),E("div",Ra,[V("p",null,Y(a.bank||"-"),1)]))])))),128)):N("",!0)])),salesman:j((({value:e})=>[V("div",{class:B([!(null==e?void 0:e.name)&&"has-text-centered"])},Y((null==e?void 0:e.name)||"-"),3)])),status:j((({value:e})=>[U(ot,{color:Be(e)?"danger":"solid",label:Be(e)?"Refund":"Complete",curved:""},null,8,["color","label"])])),salesforce:j((({value:e})=>[M(ye).canEditSalesforce&&!Be(e.status)&&e.opportunityId?(D(),E("a",{key:0,onClick:a=>at(e)},[U(ft,{color:"warning",outlined:"",icon:"lnir lnir-sales-report"})],8,La)):(D(),E("div",Ba,"-"))])),action:j((({value:e})=>[U(ht,{spaced:"",right:""},{button:j((({toggle:e})=>[U(gt,{icon:"feather:more-vertical",class:"is-trigger",onClick:e},{default:j((()=>[Ta])),_:2},1032,["onClick"])])),content:j((()=>[M(Me).canViewOrderAddress?(D(),E("a",{key:0,role:"menuitem",class:"dropdown-item is-media",onClick:a=>((e,a)=>{Qa.value=a,s.value.no=e.addressNo,s.value.subDistrict=e.addressSubDistrict,s.value.district=e.addressDistrict,s.value.province=e.addressProvince,s.value.zipcode=e.addressZipcode,He.value=e,ze.value=!0})(e,!1)},Fa,8,Aa)):N("",!0),M(ye).canEditSalesman&&!Be(e.status)?(D(),E("a",{key:1,role:"menuitem",class:"dropdown-item is-media",onClick:t=>(e=>{var t;a.value.orderId=e.id,a.value.userId=null==(t=null==e?void 0:e.salesman)?void 0:t.id,l.value=e.salesman,W.value=!0})(e)},[Wa,V("div",Ha,[V("span",null,Y(e.salesman?"Update":"Create")+" Owner",1),V("span",null,Y(e.salesman?"update":"create")+" owner",1)])],8,za)):N("",!0),M(ye).canEditSalesforce&&!Be(e.status)?(D(),E("a",{key:2,role:"menuitem",class:"dropdown-item is-media",onClick:a=>at(e)},[Ka,V("div",Xa,[V("span",null,Y(e.opportunityId?"Update":"Create")+" Salesforce",1),V("span",null,Y(e.opportunityId?"update":"create")+" opportunity id",1)])],8,Ga)):N("",!0)])),_:2},1024)])),_:1},8,["headers","data","total","is-loading","csv-custom-data"])])}}});Qa.__scopeId="data-v-bb41e9c6";export default Qa;
