var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;import{_ as i,a as d}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{C as r,g as u,e as c,p as m,c as p}from"./index.d7dc1ff6.js";import{_ as f}from"./VModal.31b4f4ba.js";import{_ as v}from"./VIconWrap.vue_vue&type=style&index=0&lang.659bfda7.js";import{_ as b}from"./VFlex.vue_vue&type=style&index=0&lang.c8620ece.js";import{_ as y}from"./CustomTabs.vue_vue&type=script&setup=true&lang.b78bee55.js";import{q as k,A as g,k as h,D as S,Y as O,ae as x,d as _,X as j,o as C,e as w,x as M,F as T,h as U,t as D,g as W,K as V,ai as H,i as I,V as N,H as P,I as Y,n as q,O as z,p as F,G as A,a as B}from"./vendor.1c8b4573.js";import{_ as E}from"./lodash.0a1ccad5.js";import{u as G}from"./useOrientationApi.ffb22b41.js";import{u as K}from"./useNotyf.ddf08f06.js";function X(){const e=k({days:[],country:r.TH,isUpdateSlot:!1,slotUpdate:{datetime:"",booked:0,total:0},slots:[],validate:{},pageNo:0,tabs:[{label:"Thailand",value:"th"},{label:"Vietnam",value:"vn"}]}),i=K(),d=g(),{user:m}=u(),{getOrientationSchedule:p,updateOrientationSchedule:f}=G(),v=["13.00","13.30","14.00","14.30","15.00","15.30","16.00","16.30","17.00","17.30","18.00","18.30","19.00","19.30","20.00"],b=["10.00","11.00","12.00","13.00","14.00","15.00","16.00","17.00","18.00","19.00","20.00","21.00"],y=t=>E.range(M.value).map((a=>{const s=S(t).add(a*w.value,"minutes").toISOString(),l=e.slots.find((e=>e.datetime===s));return{datetime:s,total:(null==l?void 0:l.total)||0,booked:(null==l?void 0:l.booked)||0}})),_=h((()=>e.tabs.filter((e=>null==m?void 0:m.manageCountry.some((t=>t===e.value)))))),j=h((()=>S().add(e.pageNo,"week").startOf("isoWeek"))),C=h((()=>S().add(e.pageNo,"week").endOf("isoWeek"))),w=h((()=>e.country===r.TH?30:60)),M=h((()=>e.country===r.TH?15:12)),T=h((()=>e.country===r.TH?13:10)),U=h((()=>e.country===r.TH?v:b)),D=h((()=>E.range(7).map((e=>{const t=j.value.clone().add(e,"days").set({hour:T.value,minute:0,second:0,millisecond:0}).toISOString();return{datetime:t,slots:y(t)}})))),W=e=>S().diff(e.datetime)>0,V=async()=>{const t=await p({startDate:j.value.toISOString(),country:e.country});e.slots=t};return O((async()=>{const t=d.query.country;e.country=t||((null==m?void 0:m.manageCountry[0])||r.TH),await V()})),H=((e,t)=>{for(var a in t||(t={}))l.call(t,a)&&n(e,a,t[a]);if(s)for(var a of s(t))o.call(t,a)&&n(e,a,t[a]);return e})({},x(e)),t(H,a({generateTimeSlot:y,userTabs:_,timeSlots:U,editSlot:t=>{W(t)||(e.isUpdateSlot=!0,e.slotUpdate=t)},updateSlot:async()=>{const t=await f({country:e.country,datetime:e.slotUpdate.datetime,numberOfSlot:+e.slotUpdate.total});200===t.status?(i.success("success!"),e.validate={},e.isUpdateSlot=!1,V()):"object"==typeof t.message?e.validate=t.message:i.error(c(t.message))},isDisableSlot:W,slotsColor:e=>{if(e.total>=1){const t=e.total-e.booked;return 0===t?"full":1===t&&e.total>1?"almost-full":t===e.total?"empty":"have-slot"}},nextWeek:async()=>{e.pageNo+=1,V()},startOfWeek:j,schedules:D,prevWeek:async()=>{e.pageNo-=1,V()},endOfWeek:C}));var H}F("data-v-400144c7");const $={class:"page-content-inner"},J={class:"columns is-multiline is-vcentered is-centered m-5"},L={class:"column is-5"},Q={class:"column is-3 has-text-centered"},R=U("label",null,"Booked",-1),Z={class:"column is-3 has-text-centered"},ee=U("label",null,"Open",-1),te={key:0,class:"column is-11"},ae={class:"validate"},se=A("Done"),le={class:"flex-table-wrapper mt-4"},oe={class:"date-pagination"},ne={class:"mx-3 title is-6 is-narrow is-bold"},ie={class:"slot-row"},de=U("div",{class:"slot-col"},[U("div",{class:"line time-header has-text-centered"},"Time/Date")],-1),re={class:"line has-text-centered time-header"},ue={class:"text-day"},ce={class:"text-date"},me={class:"slot-row"},pe={class:"slot-col"},fe=["onClick"],ve={class:"slot-item"};B();var be=_({setup(e){const{schedules:t,days:a,timeSlots:s,editSlot:l,country:o,isUpdateSlot:n,slotUpdate:r,updateSlot:u,isDisableSlot:c,slotsColor:k,validate:g,nextWeek:h,startOfWeek:O,prevWeek:x,pageNo:_,endOfWeek:F,userTabs:A}=X();return m.value="Orientation Slot",j({title:"Whitehouse: Student"}),(e,a)=>{const m=i,j=d,B=p,E=f,G=v,K=b,X=y;return C(),w("div",$,[M(E,{title:"Update Slot",open:W(n),size:"medium",actions:"center","cancel-label":"cancel",onClose:a[2]||(a[2]=e=>n.value=!1)},{content:T((()=>[U("div",J,[U("div",L,[U("h2",null," Date: "+D(W(S)(W(r).datetime).format("D MMM YYYY"))+" Time: "+D(W(S)(W(r).datetime).format("HH:mm")),1)]),U("div",Q,[M(j,null,{default:T((()=>[M(m,null,{default:T((()=>[R,V(U("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>W(r).booked=e),type:"text",class:"input",disabled:""},null,512),[[H,W(r).booked]])])),_:1})])),_:1})]),U("div",Z,[M(j,null,{default:T((()=>[M(m,null,{default:T((()=>[ee,V(U("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>W(r).total=e),type:"text",class:"input"},null,512),[[H,W(r).total]])])),_:1})])),_:1})]),W(g).numberOfSlot?(C(),w("div",te,[U("p",ae,D(W(g).numberOfSlot),1)])):I("",!0)])])),action:T((()=>[M(B,{color:"primary",raised:"",onClick:W(u)},{default:T((()=>[se])),_:1},8,["onClick"])])),_:1},8,["open"]),M(X,{modelValue:W(o),"onUpdate:modelValue":[a[3]||(a[3]=e=>z(o)?o.value=e:null),a[4]||(a[4]=t=>e.$router.push({query:{country:t}}))],tabs:W(A)},{tab:T((()=>[U("div",le,[U("div",oe,[V(M(K,{onClick:W(x)},{default:T((()=>[M(G,{icon:"feather:chevron-left",size:"medium"})])),_:1},8,["onClick"]),[[N,W(_)>0]]),U("h2",ne,D(W(S)(W(O)).format("D MMM"))+"-"+D(W(S)(W(F)).format("D MMM")),1),M(K,{onClick:W(h)},{default:T((()=>[M(G,{icon:"feather:chevron-right",size:"medium"})])),_:1},8,["onClick"])]),U("div",ie,[de,(C(!0),w(P,null,Y(W(t),(e=>(C(),w("div",{key:e.datetime,class:"slot-col"},[U("div",re,[U("h2",ue,D(W(S)(e.datetime).format("ddd")),1),U("h2",ce,D(W(S)(e.datetime).format("D MMM")),1)])])))),128))]),U("div",me,[U("div",pe,[(C(!0),w(P,null,Y(W(s),(e=>(C(),w("div",{key:e,class:"line slot-box date-header"},D(e),1)))),128))]),(C(!0),w(P,null,Y(W(t),(e=>(C(),w("div",{key:e.datetime,class:"slot-col"},[(C(!0),w(P,null,Y(e.slots,(e=>(C(),w("div",{key:e.datetime,class:q(["line slot-box",[W(c)(e)&&"disabled",W(k)(e)]]),onClick:t=>W(l)(e)},[U("div",ve,[V(U("span",null,D(e.booked)+"/"+D(e.total),513),[[N,e.total>0]])])],10,fe)))),128))])))),128))])])])),_:1},8,["modelValue","tabs"])])}}});be.__scopeId="data-v-400144c7";export default be;
