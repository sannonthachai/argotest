var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,n=(e,a)=>{for(var l in a||(a={}))s.call(a,l)&&o(e,l,a[l]);if(t)for(var l of t(a))i.call(a,l)&&o(e,l,a[l]);return e},d=(e,t)=>a(e,l(t));import{o as u,c}from"./index.d7dc1ff6.js";import{_ as r}from"./VRadio.89eaf975.js";import{_ as p}from"./SelectOption.vue_vue&type=script&setup=true&lang.934e0be4.js";import{_ as v,a as f}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{_ as m}from"./CustomTabs.vue_vue&type=script&setup=true&lang.b78bee55.js";import{_ as h}from"./VSwitchSegment.vue_vue&type=script&setup=true&lang.43f673db.js";import{d as b,r as g,o as k,e as I,h as y,H as S,I as P,A as V,b as D,z as _,q as x,D as C,k as j,ae as w,T as L,Y as O,E as U,g as T,x as A,F as G,i as N,n as Y,O as B,t as M,G as $,ao as E,ap as F,y as q,K as z,ai as K,V as R,ah as H,p as J,a as W}from"./vendor.1c8b4573.js";import{u as Q}from"./useOptionApi.f4dc99b9.js";import{u as X}from"./useGuardPartner.354c9ce1.js";import{u as Z}from"./usePartnerApi.2e3c406b.js";import"./useNotyf.ddf08f06.js";import{h as ee}from"./package.enum.de4ee89f.js";import{a as ae}from"./student.helper.13430dac.js";import"./quiz.enum.fc8b95fc.js";import"./student.enum.ad6af513.js";const le={class:"table is-hoverable is-fullwidth"},te=y("thead",null,[y("tr",null,[y("th",{scope:"col"},"fullname"),y("th",{scope:"col"},"fullname_en"),y("th",{scope:"col"},"email"),y("th",{scope:"col"},"phone"),y("th",{scope:"col"},"password"),y("th",{scope:"col"},"country"),y("th",{scope:"col"},"language")])],-1),se=[y("td",null,"จิรัฎฐ์ กิจวิชา",-1),y("td",null,"Jiradth Kitvicha",-1),y("td",null,"jiradth.kitvicha@dtac.co.th",-1),y("td",null,"062808082",-1),y("td",null,"thankyou123",-1),y("td",null,"th",-1),y("td",null,"th",-1)];var ie=b({setup:e=>(g("world"),(e,a)=>(k(),I("table",le,[te,y("tbody",null,[(k(),I(S,null,P(2,(e=>y("tr",{key:e},se))),64))])])))});J("data-v-7541f094");const oe={class:"account-box is-form is-footerless"},ne={class:"form-head-inner"},de=y("div",{class:"left"},[y("h3",null,"Add Students in Batch"),y("p",null,"add students in batch")],-1),ue={key:0,class:"right"},ce={class:"buttons"},re=$(" Clear Data "),pe=$(" Add Students "),ve={class:"form-body"},fe={class:"form-fieldset"},me={class:"columns is-multiline"},he={class:"column is-12"},be={class:"field"},ge=y("label",null,[$("Add package when create students"),y("span",{class:"red"}," * ")],-1),ke={class:"control"},Ie={key:0,class:"column is-12"},ye={class:"field"},Se=y("label",null,"Select Package",-1),Pe={class:"control"},Ve={key:0,class:"multiselect-single-label"},De=y("p",{class:"help has-text-primary"}," * If you want to add course business email writing, please search for id 323 ",-1),_e={key:0},xe={class:"field"},Ce=y("label",null,[$("Select Globish Level "),y("span",{class:"red"}," * ")],-1),je={class:"control"},we={class:"multiselect-single-label"},Le={class:"select-option-text"},Oe=y("label",null,[$("Start date "),y("span",{class:"red"}," * ")],-1),Ue=["value"],Te=y("label",null,[$("Expire date "),y("span",{class:"red"}," * ")],-1),Ae=["value"],Ge=y("span",{class:"help has-text-danger"},"* expire date for globish plus",-1),Ne={class:"column is-12"},Ye={class:"field"},Be={key:1,class:"column is-12"},Me={class:"field"},$e=y("label",null,"Student ID (Use , For more student ) ",-1),Ee={class:"help is-warning"},Fe=y("p",{class:"help has-text-danger"}," * If enter the wrong mark or the ID does not exist, the system may crash. Please enter carefully. ",-1),qe=y("label",null,"Find students ",-1),ze={class:"multiselect-tag"},Ke=["onMousedown"],Re={class:"select-option-text"},He=y("p",{class:"help has-text-danger"},"* Can choose multiple",-1),Je={key:2,class:"column is-12"},We={key:0,class:"field"},Qe={class:"control"},Xe={class:"file has-name"},Ze=y("span",{class:"file-cta"},[y("span",{class:"file-icon"},[y("i",{class:"fas fa-cloud-upload-alt"})]),y("span",{class:"file-label"}," Upload ")],-1),ea={class:"file-name light-text"},aa={key:0,class:"table-example"},la=y("label",{class:"has-text-danger"},[$("Format like this table only "),y("span",null," * ")],-1);W();var ta=b({setup(e){D(),V();const{y:a}=L(),{setPartnerBatchId:l,onSave:t,clearSeletedAddPackage:s,clearData:i,clearState:o,clearStateSwitch:b,onSelectPackage:S,disabledSave:P,validateID:J,info:W,file:le,inputStudentId:te,seletedAddPackage:se,isGlobishPlus:ta,selectType:sa,isStudentTag:ia,isLoading:oa}=function(){var e,a;const l=V(),t=D(),{createPartnerBatchStudents:s,createPartnerBatchStudentsWithCsv:i}=Z(),o=_("batchInfo"),c=x({isLoading:!1,seletedAddPackage:"0",isGlobishPlus:!1,selectType:"studentId",isStudentTag:!1,inputStudentId:void 0,validate:{},info:{batchId:0,packageId:void 0,packageName:"",studentIds:[],globishPlusLevel:void 0,startDate:C(null==(e=null==o?void 0:o.value)?void 0:e.expectedStart).format()||C().format(),expireDate:C(null==(a=null==o?void 0:o.value)?void 0:a.expectedStart).format()||""},file:void 0,validation:{}}),r=j((()=>{var e;return!!c.inputStudentId&&(null==(e=c.inputStudentId)?void 0:e.split(",").every((e=>/^\d+$/.test(e))))})),p=j((()=>{const e=!!c.isGlobishPlus&&!(c.info.globishPlusLevel||0==c.info.globishPlusLevel);return"studentCsv"==c.selectType?!c.info.batchId||!c.file||!c.info.startDate||!c.info.expireDate||e:c.isStudentTag&&c.info.studentIds?!c.info.batchId||!c.info.startDate||!c.info.expireDate||c.info.studentIds.length<=0||e:!c.info.batchId||!c.inputStudentId||!c.info.startDate||!c.info.expireDate||!r.value||e}));return d(n({},w(c)),{disabledSave:p,validateID:r,setPartnerBatchId:async()=>{c.isLoading=!0,c.info.batchId=parseInt(`${l.params.id}`),c.isLoading=!1},onSave:async()=>{var e;c.isLoading=!0;const a=null==(e=c.inputStudentId)?void 0:e.split(",").map((e=>parseInt(e))),o=C(c.info.startDate).toISOString(),r=C(c.info.expireDate).toISOString(),p={batchId:c.info.batchId,packageId:"0"===c.seletedAddPackage?void 0:c.info.packageId,startDate:o,expireDate:r};let v;if(c.isGlobishPlus&&(c.info.globishPlusLevel=0==c.info.globishPlusLevel?void 0:c.info.globishPlusLevel),"studentCsv"===c.selectType&&c.info.batchId){if(c.file){const e={batchId:`${c.info.batchId}`,packageId:"0"===c.seletedAddPackage?void 0:c.info.packageId,file:c.file,startDate:o,expireDate:r};v=await i(d(n({},e),{globishPlusLevel:c.isGlobishPlus?c.info.globishPlusLevel:void 0})),u(v,"Students in Partner Batch with CSV was created!")}}else c.info.batchId&&(v=await s(d(n({},p),{studentIds:c.isStudentTag?c.info.studentIds:a,globishPlusLevel:c.isGlobishPlus?c.info.globishPlusLevel:void 0})),u(v,"Students in Partner Batch was created!"));c.isLoading=!1,201===v.status&&t.push({name:"partners-:id-students",query:n({},l.query),params:{id:l.params.id}})},clearSeletedAddPackage:()=>{c.info.packageId=void 0,c.info.globishPlusLevel=void 0},clearData:()=>{c.inputStudentId=void 0,c.info.packageId=void 0,c.info.studentIds=[],c.info.packageName="",c.info.globishPlusLevel=void 0,c.isStudentTag=!1,c.seletedAddPackage="0",c.isGlobishPlus=!1,c.selectType="studentId",c.info.startDate=c.info.startDate,c.info.expireDate=c.info.expireDate},clearState:e=>{c.inputStudentId=void 0,c.info.studentIds=void 0,c.selectType=e},clearStateSwitch:()=>{c.inputStudentId=void 0,c.info.studentIds=void 0},onSelectPackage:(e,a)=>{c.isGlobishPlus=!!(null==a?void 0:a.featureGroupId)}})}(),{students:na}=X(),da=Object.entries(ee).map((([e,a])=>({key:e.replace(/_/g," "),value:parseInt(a)}))),ua=g(!1);O((async()=>{await l()}));const ca=j((()=>a.value>30)),{getPackages:ra,getStudents:pa}=Q(),va=async e=>{le&&(le.value=e.target.files[0])};return(e,a)=>{var l,n;const d=c,u=r,g=p,V=U("Multiselect"),D=v,_=f,x=U("v-date-picker"),C=m,j=h,w=v,L=f,O=ie;return k(),I("div",oe,[y("div",{class:Y(["form-head stuck-header",[T(ca)&&"is-stuck"]])},[y("div",ne,[de,T(na).canCreate?(k(),I("div",ue,[y("div",ce,[A(d,{icon:"lnir lnir-reload rem-100",light:"","dark-outlined":"",onClick:T(i)},{default:G((()=>[re])),_:1},8,["onClick"]),A(d,{color:"primary",loading:T(oa),disabled:T(P),raised:"",onClick:T(t)},{default:G((()=>[pe])),_:1},8,["loading","disabled","onClick"])])])):N("",!0)])],2),y("div",ve,[y("div",fe,[y("div",me,[y("div",he,[y("div",be,[ge,y("div",ke,[A(u,{modelValue:T(se),"onUpdate:modelValue":a[0]||(a[0]=e=>B(se)?se.value=e:null),value:"1",label:"Yes",name:"outlined_radio",color:"primary"},null,8,["modelValue"]),A(u,{modelValue:T(se),"onUpdate:modelValue":a[1]||(a[1]=e=>B(se)?se.value=e:null),value:"0",label:"No",name:"outlined_radio",color:"primary",onClick:T(s)},null,8,["modelValue","onClick"])])])]),parseInt(T(se))?(k(),I("div",Ie,[y("div",ye,[Se,y("div",Pe,[A(g,{key:T(W).packageId,modelValue:T(W).packageId,"onUpdate:modelValue":[a[2]||(a[2]=e=>T(W).packageId=e),T(S)],"callback-search":T(ra),"search-value":null==(l=T(W))?void 0:l.packageName,"value-prop":"id",placeholder:"select a package",onClear:a[3]||(a[3]=()=>{T(W).packageId=0,ta.value=!1})},{singlelabel:G((a=>[e.$slots.singlelabel?N("",!0):(k(),I("div",Ve," ("+M(a.value.id)+") "+M(a.value.packageName)+" ("+M(a.value.country)+") "+M(a.value.packageNameInternal&&`[${a.value.packageNameInternal}]`),1))])),option:G((e=>[$(" ("+M(e.option.id)+") "+M(e.option.packageName)+" ("+M(e.option.country)+") "+M(e.option.packageNameInternal&&`[${e.option.packageNameInternal}]`),1)])),_:1},8,["modelValue","callback-search","search-value","onUpdate:modelValue"])]),De]),T(ta)?(k(),I("div",_e,[y("div",xe,[Ce,y("div",je,[A(V,{modelValue:T(W).globishPlusLevel,"onUpdate:modelValue":a[4]||(a[4]=e=>T(W).globishPlusLevel=e),options:T(da),placeholder:"select a globish level","track-by":"key","value-prop":"value",onClear:a[5]||(a[5]=e=>T(W).globishPlusLevel=void 0)},{singlelabel:G((({value:e})=>[y("div",we,M(null==e?void 0:e.key),1)])),option:G((({option:e})=>[y("span",Le,M(null==e?void 0:e.key),1)])),_:1},8,["modelValue","options"])])])])):N("",!0),y("div",null,[A(x,{modelValue:T(W).startDate,"onUpdate:modelValue":a[6]||(a[6]=e=>T(W).startDate=e),color:"orange",masks:{input:"DD/MM/YYYY"},popover:{visibility:"click"}},{default:G((({inputValue:e,inputEvents:a})=>[Oe,A(_,null,{default:G((()=>[A(D,{class:"date-picker-box"},{default:G((()=>[y("input",E({value:e,class:"input"},F(a)),null,16,Ue)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"])]),y("div",null,[A(x,{modelValue:T(W).expireDate,"onUpdate:modelValue":a[7]||(a[7]=e=>T(W).expireDate=e),color:"orange",masks:{input:"DD/MM/YYYY"},popover:{visibility:"click"}},{default:G((({inputValue:e,inputEvents:a})=>[Te,A(_,null,{default:G((()=>[A(D,{class:"date-picker-box"},{default:G((()=>[y("input",E({value:e,class:"input"},F(a)),null,16,Ae)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"]),Ge])])):N("",!0),y("div",Ne,[y("div",Ye,[A(C,{modelValue:T(sa),"onUpdate:modelValue":[a[8]||(a[8]=e=>B(sa)?sa.value=e:null),T(o)],slider:"",class:"tab-box",tabs:[{label:"Students Id",value:"studentId"},{label:"Students CSV",value:"studentCsv"}]},{tab:G((()=>[])),_:1},8,["modelValue","onUpdate:modelValue"])])]),"studentId"===T(sa)?(k(),I("div",Be,[y("div",Me,[A(L,{grouped:""},{default:G((()=>[A(w,null,{default:G((()=>[A(j,{modelValue:T(ia),"onUpdate:modelValue":[a[9]||(a[9]=e=>B(ia)?ia.value=e:null),T(b)],"label-true":"Student Tag","label-false":"Student ID",color:"primary"},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1}),T(ia)?(k(),q(_,{key:1},{default:G((()=>[qe,A(D,null,{default:G((()=>[A(V,{modelValue:T(W).studentIds,"onUpdate:modelValue":a[12]||(a[12]=e=>T(W).studentIds=e),mode:"tags",filterResults:!1,delay:0,searchable:!0,"create-tag":!1,options:T(pa),"tag-by":"id","value-prop":"id",placeholder:"Select Student"},{tag:G((({option:e,remove:l,disabled:t})=>[y("div",ze,[$(M(T(ae)(e))+" ",1),t?N("",!0):(k(),I("i",{key:0,onClick:a[11]||(a[11]=H((()=>{}),["prevent"])),onMousedown:H((a=>l(e)),["prevent","stop"])},null,40,Ke))])])),option:G((({option:e})=>[y("span",Re,M(T(ae)(e)),1)])),_:1},8,["modelValue","options"]),He])),_:1})])),_:1})):(k(),q(L,{key:0},{default:G((()=>[$e,A(w,{icon:"feather:user","is-valid":T(J)},{default:G((()=>[z(y("input",{"onUpdate:modelValue":a[10]||(a[10]=e=>B(te)?te.value=e:null),type:"text",class:"input is-primary-focus",placeholder:"7525,4544,2315,1057"},null,512),[[K,T(te)]]),z(y("div",Ee," StudentId must be number ",512),[[R,!T(J)]]),Fe])),_:1},8,["is-valid"])])),_:1}))])])):"studentCsv"===T(sa)?(k(),I("div",Je,[T(na).canCreate?(k(),I("div",We,[y("div",Qe,[y("div",Xe,[y("label",{class:"file-label",onClick:a[13]||(a[13]=e=>ua.value=!0)},[y("input",{class:"file-input",type:"file",accept:".csv",onChange:va},null,32),Ze,y("span",ea,M((null==(n=T(le))?void 0:n.name)||"select_csv_file"),1)])])])])):N("",!0)])):N("",!0)])]),"studentCsv"===T(sa)?(k(),I("div",aa,[la,A(O)])):N("",!0)])])}}});ta.__scopeId="data-v-7541f094";export default ta;
