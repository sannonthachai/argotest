var e,a,l,t,n,o,u=Object.defineProperty,s=Object.defineProperties,d=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,v=(e,a,l)=>a in e?u(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l,p=(e,a)=>{for(var l in a||(a={}))r.call(a,l)&&v(e,l,a[l]);if(i)for(var l of i(a))c.call(a,l)&&v(e,l,a[l]);return e},m=(e,a)=>s(e,d(a));import{g as f,C as y,c as b,j as h,o as g}from"./index.d7dc1ff6.js";import{_ as k}from"./VMessage.vue_vue&type=script&setup=true&lang.1bdbe413.js";import{_,a as I}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{_ as D}from"./VRadio.89eaf975.js";import{_ as V}from"./VCheckbox.0efaaab1.js";import{_ as S}from"./ButtonFileManager.vue_vue&type=script&setup=true&lang.8d57be3d.js";import{_ as x}from"./TextEditor.7b24ebe1.js";import{_ as j}from"./FormTemplate.a6fb27bf.js";import{p as C,a as A,d as E,r as w,k as O,Y,E as U,o as T,y as M,F as B,e as P,x as L,g as N,i as F,H as $,h as q,K as R,V as H,I as G,t as K,ai as z,n as J,ao as Q,ap as W,ak as X,G as Z,q as ee,A as ae,b as le,ae as te}from"./vendor.1c8b4573.js";import{u as ne}from"./useOptionApi.f4dc99b9.js";import{s as oe,e as ue}from"./date.helper.6ae3fc87.js";import{u as se}from"./useAnnouncementApi.27030d2a.js";import"./useNotyf.ddf08f06.js";(a=e||(e={}))[a.ENABLE=1]="ENABLE",a[a.DISABLE=0]="DISABLE",(t=l||(l={})).STUDENT="student",t.COACH="coach",(o=n||(n={})).POPUP="popup",o.SLIDE="slide",o.MINI_SLIDE="mini-slide",C("data-v-e41c92f2");const de=Z("Cancel"),ie=Z("Save "),re=Z("Edit"),ce=Z("Save"),ve={class:"form-fieldset"},pe={class:"columns is-multiline"},me={class:"column is-12"},fe=q("label",null,[Z(" Topic "),q("span",{class:"red"},"*")],-1),ye=["readonly"],be=q("label",null,[Z(" Role "),q("span",{class:"red"},"*")],-1),he={class:"column is-3"},ge=q("label",null,[Z(" Announcement Type "),q("span",{class:"red"},"*")],-1),ke={class:"column is-6"},_e=q("label",null,"Status",-1),Ie={class:"column is-3"},De=q("label",null," Index ",-1),Ve=["readonly"],Se={key:0,class:"column is-4"},xe=q("label",null,"Student Countries",-1),je={class:"column is-12"},Ce=q("label",{for:""},"Product Type",-1),Ae={class:"column is-12"},Ee=q("label",{class:"label-date"},[Z(" Date range "),q("span",{class:"red"},"*")],-1),we=["value","readonly"],Oe=["value","readonly"],Ye={class:"column is-12"},Ue=q("label",null,[Z(" Image "),q("span",{class:"red"},"*")],-1),Te={key:0,class:"column is-12"},Me=["src"],Be={class:"column is-12"},Pe=q("label",null,"Link to",-1),Le=["readonly"],Ne={class:"column is-12"},Fe=q("label",null,"Link Action",-1),$e={class:"select"},qe=["disabled"],Re=["value"],He={class:"column is-12"},Ge=q("label",null,"Cookie Duration",-1),Ke={class:"column is-12"},ze=q("label",null,[Z("Announcement Detail "),q("span",{class:"red"},"*")],-1),Je={key:0},Qe={class:"column is-12"},We=q("label",null,"Specific Id",-1),Xe=["readonly"],Ze={class:"column is-12"},ea=q("label",null,"Specific Skip Id",-1),aa=["readonly"];A();var la=E({props:{title:{type:String,default:"Create New Announcement"},canEdit:{type:Boolean,default:!0},isEdit:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},validate:{type:Object,default:()=>{}},announcementInfo:{type:Object,default:void 0}},emits:["create","update","cancel"],setup(a,{emit:t}){var o,u;const s=a,d=w({start:oe(null==(o=s.announcementInfo)?void 0:o.startDate).format("YYYY-MM-DD"),end:ue(null==(u=s.announcementInfo)?void 0:u.endDate).format("YYYY-MM-DD")}),i=w([{label:"Popup",value:"popup"},{label:"Slide",value:"slide"},{label:"Mini Slide",value:"mini-slide"}]),r=w([{label:"Opens the linked document in the same frame as it was clicked (this is default)",value:"_self"},{label:"Opens the linked document in a new window or tab",value:"_blank"},{label:"Opens the linked document in the parent frame",value:"_parent"},{label:"Opens the linked document in the full body of the window",value:"_top"}]),c=[{label:"1 time/week",value:7},{label:"2 times/week",value:3.5},{label:"1 time/ 2 day",value:2},{label:"1 time/day",value:1},{label:"2 times/day",value:.5},{label:"5 times/day",value:.2},{label:"10 times/day",value:.1},{label:"Show all the time",value:0}],{getProductType:v}=ne(),{user:g}=f(),C=w((null==g?void 0:g.manageCountry)||[]),A=w([]),E=w(void 0),Z=w({name:"",idx:void 0,type:n.SLIDE,role:l.STUDENT,startDate:void 0,endDate:void 0,productTypes:[],studentCountries:null==g?void 0:g.manageCountry,status:e.DISABLE,image:void 0,link:void 0,target:"_self",cookieDuration:void 0,html:void 0,specificId:void 0,specificSkipId:void 0,specificCefr:void 0}),ee=w(1===(null==g?void 0:g.manageCountry.length)&&"vn"===(null==g?void 0:g.manageCountry[0])?[{label:"Student",value:"student"}]:[{label:"Student",value:"student"},{label:"Coach",value:"coach"}]),ae=O((()=>{var e,a,l;return!(null==(e=Z.value)?void 0:e.name)||!(null==(a=Z.value)?void 0:a.role)||!(null==(l=Z.value)?void 0:l.type)})),le=e=>{E.value=e,RegExp("image/*").test(e.type)&&(Z.value.image=e.src)},te=()=>{"slide"===Z.value.type||"mini-slide"===Z.value.type?Z.value=m(p({},Z.value),{cookieDuration:void 0,html:void 0,target:"_self"}):Z.value=m(p({},Z.value),{image:void 0,link:void 0,target:void 0})},se=()=>{Z.value.specificId=Z.value.specificSkipId=void 0,"student"===Z.value.role?Z.value.studentCountries=(null==g?void 0:g.manageCountry)||Object.values(y):Z.value.studentCountries=void 0},la=e=>{var a;return!!(null==(a=Z.value.productTypes)?void 0:a.some((a=>a===e)))},ta=()=>m(p({},Z.value),{startDate:oe(d.value.start).toISOString(),endDate:ue(d.value.end).toISOString()}),na=()=>{t("create",ta())},oa=()=>{t("update",ta())};return Y((async()=>{var e,a;A.value=await v(),s.announcementInfo?Z.value={name:s.announcementInfo.name,type:s.announcementInfo.type,idx:s.announcementInfo.idx,role:s.announcementInfo.role,startDate:s.announcementInfo.startDate,endDate:s.announcementInfo.endDate,productTypes:s.announcementInfo.productTypes,studentCountries:s.announcementInfo.studentCountries,status:s.announcementInfo.status,image:s.announcementInfo.image,link:s.announcementInfo.link,target:s.announcementInfo.target,cookieDuration:parseFloat(`${s.announcementInfo.cookieDuration}`),html:s.announcementInfo.html,specificId:null==(e=s.announcementInfo.specificId)?void 0:e.join(","),specificSkipId:null==(a=s.announcementInfo.specificSkipId)?void 0:a.join(",")}:Z.value.productTypes=A.value.map((({value:e})=>e))})),(e,l)=>{const t=b,n=k,o=_,u=I,s=U("Multiselect"),v=D,p=V,m=h,f=U("v-date-picker"),y=S,g=x,E=_,w=I,O=j;return T(),M(O,{title:a.title},{buttons:B((()=>[a.isEdit||a.readonly?(T(),P($,{key:0},[L(t,{icon:"feather:arrow-left",to:{name:"settings-announcements"}},{default:B((()=>[de])),_:1}),a.isEdit?(T(),M(t,{key:0,color:"primary",icon:"feather:save",disabled:N(ae),onClick:oa},{default:B((()=>[ie])),_:1},8,["disabled"])):a.canEdit&&a.readonly?(T(),M(t,{key:1,color:"primary",icon:"feather:edit",to:"#edit"},{default:B((()=>[re])),_:1})):F("",!0)],64)):(T(),M(t,{key:1,color:"primary",icon:"feather:save",disabled:N(ae),onClick:na},{default:B((()=>[ce])),_:1},8,["disabled"]))])),default:B((()=>[q("div",ve,[R(L(n,{color:"danger",closable:""},{default:B((()=>[(T(!0),P($,null,G(a.validate,((e,a)=>(T(),P("span",{key:a,class:"is-flex"},[q("span",null,K(a)+": "+K(e),1)])))),128))])),_:1},512),[[H,Object.values(a.validate).length]]),q("div",pe,[q("div",me,[L(u,null,{default:B((()=>[fe,L(o,{"has-error":!!a.validate.name},{default:B((()=>[R(q("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>Z.value.name=e),type:"text",class:"input",placeholder:"fill topic/remark...",readonly:a.readonly},null,8,ye),[[z,Z.value.name]]),R(q("p",{class:"help has-text-danger"},K(a.validate.name),513),[[H,a.validate.name]])])),_:1},8,["has-error"])])),_:1})]),q("div",{class:J(["column",["student"===Z.value.role&&"is-3","coach"===Z.value.role&&"is-3"]])},[L(u,null,{default:B((()=>[be,L(o,{"has-error":!!a.validate.role},{default:B((()=>[L(s,{modelValue:Z.value.role,"onUpdate:modelValue":[l[1]||(l[1]=e=>Z.value.role=e),se],options:ee.value,disabled:a.readonly,"can-clear":!1,placeholder:"Select role","value-prop":"value","track-by":"value",label:"label"},null,8,["modelValue","options","disabled"]),R(q("p",{class:"help text-danger"},K(a.validate.role),513),[[H,a.validate.role]])])),_:1},8,["has-error"])])),_:1})],2),q("div",he,[L(u,null,{default:B((()=>[ge,L(o,{"has-error":!!a.validate.type},{default:B((()=>[L(s,{modelValue:Z.value.type,"onUpdate:modelValue":[l[2]||(l[2]=e=>Z.value.type=e),te],options:i.value,disabled:a.readonly,"can-clear":!1,placeholder:"Select type","value-prop":"value","track-by":"value",label:"label"},null,8,["modelValue","options","disabled"]),R(q("p",{class:"help text-danger"},K(a.validate.type),513),[[H,a.validate.type]])])),_:1},8,["has-error"])])),_:1})]),q("div",ke,[L(u,null,{default:B((()=>[_e,L(o,{"has-error":!!a.validate.status},{default:B((()=>[L(v,{modelValue:Z.value.status,"onUpdate:modelValue":l[3]||(l[3]=e=>Z.value.status=e),value:1,disabled:a.readonly,label:"Enable",name:"status",color:"primary",square:""},null,8,["modelValue","disabled"]),L(v,{modelValue:Z.value.status,"onUpdate:modelValue":l[4]||(l[4]=e=>Z.value.status=e),value:0,disabled:a.readonly,label:"Disable",name:"status",color:"primary",square:""},null,8,["modelValue","disabled"]),R(q("p",{class:"help text-danger"},K(a.validate.status),513),[[H,a.validate.status]])])),_:1},8,["has-error"])])),_:1})]),q("div",Ie,[L(u,null,{default:B((()=>[De,L(o,{"has-error":!!a.validate.idx},{default:B((()=>[R(q("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>Z.value.idx=e),type:"number",class:"input",placeholder:"fill index..",readonly:a.readonly},null,8,Ve),[[z,Z.value.idx]]),R(q("p",{class:"help has-text-danger"},K(a.validate.name),513),[[H,a.validate.name]])])),_:1},8,["has-error"])])),_:1})]),"student"===Z.value.role?(T(),P("div",Se,[L(u,null,{default:B((()=>[xe,L(o,{"has-error":!!a.validate.studentCountries},{default:B((()=>[(T(!0),P($,null,G(C.value,((e,t)=>(T(),M(p,{key:t,modelValue:Z.value.studentCountries,"onUpdate:modelValue":l[6]||(l[6]=e=>Z.value.studentCountries=e),disabled:a.readonly,value:e,label:e,color:"primary"},null,8,["modelValue","disabled","value","label"])))),128)),R(q("p",{class:"help text-danger"},K(a.validate.studentCountries),513),[[H,a.validate.studentCountries]])])),_:1},8,["has-error"])])),_:1})])):F("",!0),q("div",je,[L(u,null,{default:B((()=>[Ce,L(o,{"has-error":!!a.validate.productType,class:"columns is-multiline p-3"},{default:B((()=>[(T(!0),P($,null,G(A.value,((e,t)=>(T(),M(p,{key:`t-${e}-${t}`,modelValue:Z.value.productTypes,"onUpdate:modelValue":l[7]||(l[7]=e=>Z.value.productTypes=e),value:e.value,label:e.label,disabled:a.readonly,color:"primary",solid:la(e.value),class:"column is-4"},null,8,["modelValue","value","label","disabled","solid"])))),128))])),_:1},8,["has-error"])])),_:1})]),q("div",Ae,[L(f,{modelValue:d.value,"onUpdate:modelValue":l[8]||(l[8]=e=>d.value=e),"is-range":"",color:"orange","trim-weeks":"","model-config":{start:{type:"string",mask:"YYYY-MM-DD",timeAdjust:"00:00:00"},end:{type:"string",mask:"YYYY-MM-DD",timeAdjust:"23:59:59"}},masks:{input:"DD/MM/YYYY"},popover:{visibility:a.readonly?"":"click"}},{default:B((({inputValue:e,inputEvents:l})=>[Ee,L(u,{addons:""},{default:B((()=>[L(o,null,{default:B((()=>[q("input",Q({value:e.start,class:"input",readonly:a.readonly},W(l.start)),null,16,we)])),_:2},1024),L(o,null,{default:B((()=>[L(m,{icon:"feather:arrow-right",class:"is-static"})])),_:1}),L(o,null,{default:B((()=>[q("input",Q({value:e.end,class:"input",readonly:a.readonly},W(l.end)),null,16,Oe)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue","popover"])]),"slide"===Z.value.type||"mini-slide"===Z.value.type?(T(),P($,{key:1},[q("div",Ye,[L(u,null,{default:B((()=>[Ue,L(o,{"has-error":!!a.validate.image},{default:B((()=>[a.readonly?F("",!0):(T(),M(y,{key:0,text:"Select Image",onSubmit:le})),R(q("p",{class:"help text-danger"},K(a.validate.image),513),[[H,a.validate.image]])])),_:1},8,["has-error"])])),_:1})]),Z.value.image?(T(),P("div",Te,[q("img",{src:Z.value.image,alt:"",srcset:""},null,8,Me)])):F("",!0),q("div",Be,[L(u,null,{default:B((()=>[Pe,L(o,{"has-error":!!a.validate.link},{default:B((()=>[R(q("input",{"onUpdate:modelValue":l[9]||(l[9]=e=>Z.value.link=e),type:"text",class:"input",placeholder:"click image with link",readonly:a.readonly},null,8,Le),[[z,Z.value.link]]),R(q("p",{class:"help text-danger"},K(a.validate.link),513),[[H,a.validate.link]])])),_:1},8,["has-error"])])),_:1})]),q("div",Ne,[L(u,null,{default:B((()=>[Fe,L(o,{"has-error":!!a.validate.target},{default:B((()=>[q("div",$e,[R(q("select",{"onUpdate:modelValue":l[10]||(l[10]=e=>Z.value.target=e),disabled:a.readonly,placeholder:"select link action..."},[(T(!0),P($,null,G(r.value,((e,a)=>(T(),P("option",{key:`${e.value}-${a}`,value:e.value},K(e.label),9,Re)))),128))],8,qe),[[X,Z.value.target]])]),R(q("p",{class:"help text-danger"},K(a.validate.target),513),[[H,a.validate.target]])])),_:1},8,["has-error"])])),_:1})])],64)):(T(),P($,{key:2},[q("div",He,[L(u,null,{default:B((()=>[Ge,L(o,{"has-error":!!a.validate.cookieDuration},{default:B((()=>[L(s,{modelValue:Z.value.cookieDuration,"onUpdate:modelValue":l[11]||(l[11]=e=>Z.value.cookieDuration=e),options:c,disabled:a.readonly,"can-clear":!1,placeholder:"select cookie duration...","value-prop":"value","track-by":"value",label:"label"},null,8,["modelValue","disabled"]),R(q("p",{class:"help text-danger"},K(a.validate.cookieDuration),513),[[H,a.validate.cookieDuration]])])),_:1},8,["has-error"])])),_:1})]),q("div",Ke,[L(u,null,{default:B((()=>[ze,L(o,{"has-error":!!a.validate.html,class:"is-relative"},{default:B((()=>[Z.value.html?(T(),P("div",Je)):F("",!0),L(g,{modelValue:Z.value.html,"onUpdate:modelValue":[l[12]||(l[12]=e=>Z.value.html=e),l[13]||(l[13]=e=>Z.value.html=e)],readonly:a.readonly},null,8,["modelValue","readonly"]),R(q("p",{class:"help text-danger"},K(a.validate.html),513),[[H,a.validate.html]])])),_:1},8,["has-error"])])),_:1})])],64)),q("div",Qe,[L(w,null,{default:B((()=>[We,L(E,null,{default:B((()=>[R(q("input",{"onUpdate:modelValue":l[14]||(l[14]=e=>Z.value.specificId=e),type:"text",placeholder:"fill specific id...",class:"input",readonly:a.readonly},null,8,Xe),[[z,Z.value.specificId]])])),_:1})])),_:1})]),q("div",Ze,[L(w,null,{default:B((()=>[ea,L(E,null,{default:B((()=>[R(q("input",{"onUpdate:modelValue":l[15]||(l[15]=e=>Z.value.specificSkipId=e),type:"text",placeholder:"fill specific skip id...",class:"input",readonly:a.readonly},null,8,aa),[[z,Z.value.specificSkipId]])])),_:1})])),_:1})])])])])),_:1},8,["title"])}}});function ta(){const e=ee({validate:{},announcementInfo:void 0}),a=ae(),l=le(),t=O((()=>parseInt(a.params.id))),{createAnnouncement:n,getAnnouncementById:o,updateAnnouncement:u}=se();return m(p({},te(e)),{addAnnouncement:async a=>{const t=await n(p({},a));if(g(t,"Add Announcement Success!"),null==t?void 0:t.code){if("object"==typeof(null==t?void 0:t.message))return void(e.validate=null==t?void 0:t.message)}else l.push({name:"settings-announcements"})},fetchAnnouncementById:async()=>{const a=await o(t.value);a&&(e.announcementInfo=a)},updateAnnouncementById:async a=>{const n=await u(t.value,a);if(g(n,"Update Announcement Success!"),null==n?void 0:n.code){if("object"==typeof(null==n?void 0:n.message))return void(e.validate=null==n?void 0:n.message)}else l.push({name:"settings-announcements-:id",params:{id:t.value}})}})}la.__scopeId="data-v-e41c92f2";export{la as _,ta as u};
