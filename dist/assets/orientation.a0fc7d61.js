var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(a,t,i)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,r=(e,a)=>{for(var t in a||(a={}))n.call(a,t)&&l(e,t,a[t]);if(i)for(var t of i(a))s.call(a,t)&&l(e,t,a[t]);return e},o=(e,i)=>a(e,t(i));import{e as u,c as d,h as c}from"./index.d7dc1ff6.js";import{A as p,O as v,_ as m}from"./ModalOrientationEditor.5e2952bc.js";import{_ as f,a as g}from"./VField.vue_vue&type=script&setup=true&lang.ef5e6c86.js";import{_ as b}from"./VTag.vue_vue&type=script&setup=true&lang.b31af8ee.js";import{_ as y}from"./Datatable.aae3ef08.js";import{_ as k}from"./FormTemplate.a6fb27bf.js";import{q as O,A as j,b as h,Y as w,ae as S,d as _,r as P,z as I,E as D,o as E,y as C,F as N,g as R,e as V,x as A,i as $,au as x,h as T,K as F,ak as L,O as Y,t as q,G,D as H}from"./vendor.1c8b4573.js";import{u as M}from"./useGuardPartner.354c9ce1.js";import{t as W}from"./date.helper.6ae3fc87.js";import{u as z}from"./useOrientationApi.ffb22b41.js";import{u as B}from"./usePartnerApi.2e3c406b.js";import{u as K}from"./useNotyf.ddf08f06.js";import{u as U}from"./usePaginationRoute.780ca235.js";import"./SelectOption.vue_vue&type=script&setup=true&lang.934e0be4.js";import"./index.8f8d8101.js";import"./VModal.31b4f4ba.js";import"./useOptionApi.f4dc99b9.js";import"./quiz.enum.fc8b95fc.js";import"./student.helper.13430dac.js";import"./student.enum.ad6af513.js";import"./VPlaceholderSection.vue_vue&type=script&setup=true&lang.35b0ad2a.js";import"./VLoader.vue_vue&type=script&setup=true&lang.a96d7daf.js";import"./VFlexPagination.86ce707c.js";import"./search-4-dark.fb3880a5.js";import"./index.ec15dc7d.js";import"./lodash.0a1ccad5.js";function J(){const e=O({orientaionList:[],total:0,isLoading:!0,filterStatus:void 0,validation:{}}),a=j(),t=h(),i=K(),n=a.params.id,{currentPage:s,perPage:l,search:d}=U(),{updateOrientation:c}=z(),{getPartnerOrientations:p,createPartnerOrientation:v}=B();w((()=>{(async()=>{e.isLoading=!0,e.filterStatus=a.query.status;const t=await p({currentPage:s,perPage:l,search:d,status:e.filterStatus,partnerBatchId:+n});t&&(e.orientaionList=t.data,e.total=t.total,e.isLoading=!1)})()}));return o(r({},S(e)),{orientTableHeaders:[{key:"id",label:"ID"},{key:"appointStatus",label:"Appoint Status"},{key:"operator",label:"Operator",isRaw:!0},{key:"package",label:"Package",isRaw:!0},{key:"student",label:"Student",isRaw:!0},{key:"date",label:"Date",isRaw:!0},{key:"time",label:"Time",isRaw:!0},{key:"orientedStatus",label:"Orient Status"},{key:"action",label:"Action",isRaw:!0,isEnd:!0}],selectFilterStatus:()=>{t.push({name:"partners-:id-orientation",query:o(r({},a.query),{status:e.filterStatus})})},createPartnerOrientation:async a=>{a=o(r({},a),{studentId:void 0,packageItemId:void 0,orientedStatus:void 0});const s=await v(+n,a);201===s.status?(i.success("Your created successfully!"),t.go(0)):("object"==typeof s.message&&(e.validation=s.message),i.error(u(s.message)||"Fail! Please try again"))},updatePartnerOrientation:async(a,n)=>{const s=await c(a,n);200===s.status?(i.success("Your created successfully!"),t.go(0)):("object"==typeof s.message&&(e.validation=s.message),i.error(u(s.message)||"Fail! Please try again"))}})}const Q={key:0,class:"is-flex is-justify-content-flex-start pt-4"},X=G("Create Orientation"),Z={class:"columns search-filter"},ee={class:"column"},ae=T("label",null,"Filter Orientation",-1),te={class:"select"},ie=[T("option",{value:void 0},"All Orientations",-1),T("option",{value:"wait_to_orientation"}," Wait to Orientation ",-1),T("option",{value:"wait_to_call"},"Wait to Call",-1),T("option",{value:"done"},"Done",-1)],ne={key:1},se={key:1},le={key:1},re={key:1},oe={class:"dark-inverted is-flex is-justify-content-flex-end"},ue=G("Action"),de=["onClick"],ce=[T("div",{class:"icon"},[T("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),T("div",{class:"meta"},[T("span",null,"View"),T("span",null,"View Orientation Detail")],-1)],pe=["onClick"],ve=[T("div",{class:"icon"},[T("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),T("div",{class:"meta"},[T("span",null,"Edit"),T("span",null,"Edit Orientation Detail")],-1)];var me=_({setup(e){const{orientTableHeaders:a,orientaionList:t,filterStatus:i,selectFilterStatus:n,total:s,isLoading:l,validation:r,createPartnerOrientation:o,updatePartnerOrientation:u}=J(),{partnerOrientation:O,partnerOrientationActionButton:j}=M(),h=e=>{switch(e){case v.DONE:return"Done";case v.ORIENTING:return"Orienting";case v.SKIP:return"Skip";case v.DEVICE_READY:return"Device Ready";default:return}},w=e=>{switch(e){case p.DONE:return"Wait to Orient";case p.NONE:return"Wait to Call";default:return}},S=e=>{switch(e){case v.DONE:return"success";case v.ORIENTING:return"danger";default:return"white"}},_=P(!1),z=P(!1),B=P(!1),K=P(void 0),U=P(0),me=P(!1),fe=P({userId:0,datetime:void 0,appointStatus:p.NONE,note:""}),ge=P(fe.value),be=I("batchInfo"),ye=(e,a=!1)=>{var t,i;U.value=e.id,K.value=e,ge.value={datetime:H(null==e?void 0:e.datetime).isValid()?H(null==e?void 0:e.datetime).toDate():void 0,note:(null==e?void 0:e.note)||"",userId:(null==(t=null==e?void 0:e.admin)?void 0:t.id)||0,studentId:null==(i=null==e?void 0:e.student)?void 0:i.id,packageItemId:null==e?void 0:e.packageItemId,appointStatus:(null==e?void 0:e.appointStatus)||p.NONE,orientedStatus:(null==e?void 0:e.orientedStatus)||null},me.value=!1,z.value=a,K.value&&(_.value=!0)},ke=()=>{_.value=!0,B.value=!0,me.value=!0},Oe=()=>{_.value=!1,z.value=!1,B.value=!1,K.value=void 0,ge.value=fe.value};return(e,p)=>{const v=d,P=m,I=f,H=g,M=b,J=D("RouterLink"),fe=c,je=y,he=k;return E(),C(he,{title:"Orientation"},{buttons:N((()=>[])),default:N((()=>{var e;return[R(O).canCreate?(E(),V("div",Q,[A(v,{color:"primary",icon:"fas fa-plus",onClick:ke},{default:N((()=>[X])),_:1})])):$("",!0),A(P,{"open-modal":_.value,"orient-info":ge.value,"is-edit":z.value,data:K.value,"is-create":B.value,"is-from-partner":me.value,validation:R(r),"batch-id":null==(e=R(be))?void 0:e.id,onOnCreate:p[0]||(p[0]=e=>R(o)(e)),onOnChange:p[1]||(p[1]=e=>(async e=>{await u(U.value,e)})(e)),onToggleClose:Oe},null,8,["open-modal","orient-info","is-edit","data","is-create","is-from-partner","validation","batch-id"]),A(je,{"is-loading":R(l),"search-placeholder":"Search by Orietation ID, Student, Package",headers:R(a),data:R(t),total:R(s)},x({"custom-left":N((()=>[T("div",Z,[T("div",ee,[A(H,null,{default:N((()=>[ae,A(I,null,{default:N((()=>[T("div",te,[F(T("select",{"onUpdate:modelValue":p[2]||(p[2]=e=>Y(i)?i.value=e:null),onChange:p[3]||(p[3]=(...e)=>R(n)&&R(n)(...e))},ie,544),[[L,R(i)]])])])),_:1})])),_:1})])])])),appointStatus:N((({value:e})=>[e?(E(),C(M,{key:0,color:"done"===e?"warning":"white",label:w(e),rounded:"",elevated:""},null,8,["color","label"])):(E(),V("p",ne,"-"))])),operator:N((({value:e})=>{var a,t;return[T("p",null,q((null==e?void 0:e.admin)?`(${null==(a=null==e?void 0:e.admin)?void 0:a.id}) ${null==(t=null==e?void 0:e.admin)?void 0:t.fullname}`:"-"),1)]})),package:N((({value:e})=>[e.package?(E(),C(J,{key:0,to:`/products/packages/${e.package.id}`,target:"_blank",class:"link"},{default:N((()=>[G(q(`(${e.package.id}) ${e.package.packageName}`),1)])),_:2},1032,["to"])):(E(),V("p",se,"-"))])),student:N((({value:e})=>[e.student?(E(),C(J,{key:0,to:`/students/${e.student.id}`,target:"_blank",class:"link"},{default:N((()=>[G(q(`(${e.student.id}) ${e.student.fullnameTh||e.student.fullnameEn} (Tel: ${e.student.phone||"-"})`),1)])),_:2},1032,["to"])):(E(),V("p",le,"-"))])),date:N((({value:e})=>[G(q(e.datetime?R(W)(e.datetime,"DD/MM/YYYY"):"-"),1)])),time:N((({value:e})=>[G(q(e.datetime?R(W)(e.datetime,"HH:mm:ss"):"-"),1)])),orientedStatus:N((({value:e})=>[e?(E(),C(M,{key:0,color:S(e),label:h(e),rounded:"",elevated:""},null,8,["color","label"])):(E(),V("p",re,"-"))])),_:2},[R(j)?{name:"action",fn:N((({value:e})=>[T("div",oe,[A(fe,{spaced:"",right:""},{button:N((({toggle:e})=>[A(v,{icon:"feather:more-vertical",class:"is-trigger",onClick:e},{default:N((()=>[ue])),_:2},1032,["onClick"])])),content:N((()=>[R(O).canView?(E(),V("a",{key:`view-${e.id}`,role:"menuitem",class:"dropdown-item is-media",onClick:a=>ye(e)},ce,8,de)):$("",!0),R(O).canEdit?(E(),V("a",{key:`edit-${e.id}`,role:"menuitem",class:"dropdown-item is-media",onClick:a=>ye(e,!0)},ve,8,pe)):$("",!0)])),_:2},1024)])]))}:void 0]),1032,["is-loading","headers","data","total"])]})),_:1})}}});export default me;
